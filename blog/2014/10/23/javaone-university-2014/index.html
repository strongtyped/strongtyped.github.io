
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>2014 JavaOne University: Functional Programming in Scala - Strong[Typed]</title>
  <meta name="author" content="StrongTyped.io">

  
  <meta name="description" content="Strong[Typed] blog 2014 JavaOne University: Functional Programming in Scala written October 23, 2014 in Posted by Luc Duponcheel This blog post &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.strongtyped.io/blog/2014/10/23/javaone-university-2014">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Strong[Typed]" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50926236-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Exo:400,500,600,500italic,600italic" rel="stylesheet" type="text/css">

</head>

<!-- _layouts/default.html -->
  <body>

    <!-- _layouts/post.html -->

<div class="navbar">
  <div class="navbar-fixed-top">
      <div class="container">
      <ul class="nav navbar-left">
        <li>
          <h2 class="strongtyped"><a href="/"><span class="strong">Strong<span><span class="typed">[Typed]</span></a></h2>
        </li>
      </ul>
      <ul class="nav secondary-nav navbar-nav navbar-right">
  <li><a id="blog-nav" href="/blog">blog</a></li>
</ul>      
    </div>
  </div>
</div>


<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        <h1>2014 JavaOne University: Functional Programming in Scala</h1>
        <!-- post/metadata.html --> 
<span class="meta">
  written 








  



<time datetime="2014-10-23T09:00:00+02:00" pubdate data-updated="true">October 23, 2014</time>  
in 


<br/>
  

<span class="byline author vcard">Posted by <span class="fn">Luc Duponcheel</span></span>

</span>
        <p>This blog post correponds to my 2014 JavaOne University course.</p>

<p>The content of this blog post (deliberately) does not really go into all details.</p>

<!-- more -->


<h2>Course content</h2>

<p>This course is about <em>functional programming patterns</em> in general,
and functional programming patterns <em>related to datasources</em> in particular.</p>

<h2>Course approach</h2>

<p>The course describes a <em>Scala library</em> that formalizes functional datasource patterns.</p>

<h2>Back to school</h2>

<p>One of the main goals of this course is to illustrate that datasources are closely related to concepts you learned in school.</p>

<h2>Multiplication</h2>

<p>Most probably, you remember the <em>multiplication</em> operator</p>

<ul>
<li><code>*</code> for integers</li>
<li><code>and</code> for booleans</li>
<li>&hellip;</li>
</ul>


<p>Most probably, you also remember that the multiplication operators above have a <em>neutral</em> element</p>

<ul>
<li><code>1</code> for integers</li>
<li><code>true</code> for booleans</li>
<li>&hellip;</li>
</ul>


<h2>Multiplicative data</h2>

<p>At this moment we do a big (not to say gigantic) step forwards by, somehow, <em>adding data</em> to the multiplication operator above. An important question to answer is: what should be the <em>data semantics</em> associated with multiplication?</p>

<p><em>Multiplicative data</em> are formalized by the <code>trait</code>&rsquo;s below</p>

<figure class='code'><figcaption><span>HasOne  (HasOne.scala)</span> <a href='/downloads/code/HasOne.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">HasOneModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">HasOne</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">HasOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Multiplicative  (Multiplicative.scala)</span> <a href='/downloads/code/Multiplicative.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">MultiplicativeModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">HasOneModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Multiplicative</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Multiplicative</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">HasOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">d_a2b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span> <span class="k">=&gt;</span> <span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">end</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2b</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">and</span> <span class="n">one</span><span class="o">(</span><span class="n">a2b</span><span class="o">)</span>
</span><span class='line'>      <span class="k">def</span> <span class="o">**[</span><span class="kt">B</span><span class="o">](</span><span class="n">db</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span> <span class="kt">**</span> <span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">and</span> <span class="o">(</span>
</span><span class='line'>          <span class="n">db</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">b</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span>
</span><span class='line'>          <span class="o">})</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>where <em>Runnable</em> is formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Runnable  (Runnable.scala)</span> <a href='/downloads/code/Runnable.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">In</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">In</span><span class="o">)</span><span class="k">:</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the <em>Product Type</em> <code>Z ** Y</code> is defined as</p>

<figure class='code'><figcaption><span>Product  (Product.scala)</span> <a href='/downloads/code/Product.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">type</span> <span class="kt">**</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">Z</span><span class="o">,</span> <span class="n">Y</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait HasOneModule</code></p>

<ul>
<li>declares the type <code>D[Z]</code> as a subtype of <code>Multiplicative[Z]</code></li>
<li>declares the function <code>one</code>

<ul>
<li>given a value <code>z</code> of type <code>Z</code>, <code>one(z)</code> should produce <code>z</code></li>
</ul>
</li>
</ul>


<p><code>trait Multiplicative[A]</code></p>

<ul>
<li>declares the method <code>and</code>

<ul>
<li>given <code>da</code>, somehow producing values of type <code>A</code>, and <code>d_a2b</code>, somehow producing values of type <code>A =&gt; B</code>, <code>da and d_a2b</code> should, somehow, using the values produced by <code>da</code> and <code>d_a2b</code>, produce values of type <code>B</code></li>
</ul>
</li>
<li>defines the method <code>end</code> in terms of <code>and</code> and <code>one</code></li>
<li>defines the method <code>**</code> in terms of <code>and</code> and <code>end</code></li>
</ul>


<p><em>Note:</em> This &ldquo;declares the type <code>D[Z]</code> as a subtype of <code>Something[Z]</code>&rdquo; is such a common theme that we are not going to repeat it over and over again.</p>

<h2>Domain Specific Language</h2>

<p>The functions and methods of <code>MultiplicativeModule</code> constitute a <em>DSL</em>.</p>

<p><em>Note:</em> This &ldquo;the functions and methods of <code>SomethingModule</code> constitute a <em>DSL</em>&rdquo; is such a common theme that we are not going to repeat it over and over again.</p>

<h2>Multiplicative data usage</h2>

<p>The code below defines some examples that make use of the multiplicative data DSL</p>

<figure class='code'><figcaption><span>MultiplicativeUsage  (MultiplicativeUsage.scala)</span> <a href='/downloads/code/MultiplicativeUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">MultiplicativeUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.MultiplicativeModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">mm</span><span class="k">:</span> <span class="kt">MultiplicativeModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">mm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative01</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">**</span> <span class="n">di</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative02</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="o">**</span> <span class="n">di</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative03</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">),</span> <span class="n">i3</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="o">**</span> <span class="n">di</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative04</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="o">**</span> <span class="n">di</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative05</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">i2</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">i1</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">i1</span> <span class="o">+</span> <span class="n">i2</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative06</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">),</span> <span class="n">i3</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">i3</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">i2</span> <span class="k">=&gt;</span>
</span><span class='line'>                  <span class="n">i1</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="n">i1</span> <span class="o">+</span> <span class="n">i2</span> <span class="o">+</span> <span class="n">i3</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">multiplicative07</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">),</span> <span class="n">i3</span><span class="o">),</span> <span class="n">i4</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">one</span><span class="o">(</span><span class="n">i4</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">i4</span> <span class="k">=&gt;</span>
</span><span class='line'>                  <span class="n">i3</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="n">i2</span> <span class="k">=&gt;</span>
</span><span class='line'>                      <span class="n">i1</span> <span class="k">=&gt;</span>
</span><span class='line'>                        <span class="n">i1</span> <span class="o">+</span> <span class="n">i2</span> <span class="o">+</span> <span class="n">i3</span> <span class="o">+</span> <span class="n">i4</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span> <span class="k">=</span> <span class="n">multiplicative01</span><span class="o">(</span><span class="mi">1</span><span class="o">)(</span><span class="n">one</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span> <span class="k">=</span> <span class="n">multiplicative02</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span> <span class="k">=</span> <span class="n">multiplicative03</span><span class="o">(((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">4</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example04</span> <span class="k">=</span> <span class="n">multiplicative04</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example05</span> <span class="k">=</span> <span class="n">multiplicative05</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example06</span> <span class="k">=</span> <span class="n">multiplicative06</span><span class="o">(((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example07</span> <span class="k">=</span> <span class="n">multiplicative07</span><span class="o">((((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">),</span> <span class="mi">4</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">multiplicative_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example01</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example02</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example03</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example04</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example05</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example06</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example07</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think about expressions like <code>one(i1) ** one(i2) ** di</code>
as generalizations of expressions like <code>a * b * x</code>
that also <em>produce accumulated data</em>.</p>

<p>Above we defined <em>abstract</em> examples that make use of the multiplicative data DSL
before defining any <em>concrete</em> multiplicative data <em>instance</em>.
Think of it as <em>programming to an interface</em>.</p>

<p>Below is a trivial <code>Runnable</code> implementation</p>

<figure class='code'><figcaption><span>TrivialRunnableModule  (TrivialRunnableModule.scala)</span> <a href='/downloads/code/TrivialRunnableModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TrivialRunnableModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">In</span> <span class="o">=</span> <span class="nc">Unit</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">In</span><span class="o">)</span><span class="k">:</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest <code>MultiplicativeModule</code> instance one can think of is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">OneModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">case</span> <span class="k">class</span> <span class="nc">One</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>One[Z]</code> as a data source that produces <em>one value</em>.</p>

<p>Given a <code>One[Z]</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>OneMultiplicativeUsage  (OneMultiplicativeUsage.scala)</span> <a href='/downloads/code/OneMultiplicativeUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">OneMultiplicativeUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">MultiplicativeUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.OneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">mm</span><span class="k">:</span> <span class="kt">OneModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">OneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>OneMultiplicativeUsageInApp  (OneMultiplicativeUsageInApp.scala)</span> <a href='/downloads/code/OneMultiplicativeUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.OneMultiplicativeUsage._</span>
</span><span class='line'>      <span class="n">multiplicative_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="mi">3</span><span class="o">),</span><span class="mi">4</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,(</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">3</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">6</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">10</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Addition</h2>

<p>Most probably, you remember the <em>addition</em> operator</p>

<ul>
<li><code>+</code> for integers</li>
<li><code>or</code> for booleans</li>
<li>&hellip;</li>
</ul>


<p>Most probably, you also remember that the addition operators above have a <em>neutral</em> element</p>

<ul>
<li><code>0</code> for integers</li>
<li><code>false</code> for booleans</li>
<li>&hellip;</li>
</ul>


<h2>Additive data</h2>

<p>Again, an important question to answer is: what should be the data semantics associated with addition be?</p>

<p><em>Additive data</em> are formalized by the <code>trait</code>&rsquo;s below</p>

<figure class='code'><figcaption><span>HasZero  (HasZero.scala)</span> <a href='/downloads/code/HasZero.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">HasZeroModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">HasZero</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">zero</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">HasZero</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Additive  (Additive.scala)</span> <a href='/downloads/code/Additive.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">AdditiveModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">HasZeroModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Additive</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Additive</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">HasZero</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">take</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">or</span><span class="o">(</span><span class="n">da1</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">def</span> <span class="o">++[</span><span class="kt">B</span><span class="o">](</span><span class="n">db</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span> <span class="kt">++</span> <span class="kt">B</span><span class="o">]</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>where the <em>Sum Type</em> <code>Z ++ Y</code> is defined as</p>

<figure class='code'><figcaption><span>Sum  (Sum.scala)</span> <a href='/downloads/code/Sum.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">type</span> <span class="kt">++</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Either</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait HasZeroModule</code></p>

<ul>
<li>declares the function <code>zero</code>

<ul>
<li><code>zero(())</code> should produce no values</li>
</ul>
</li>
</ul>


<p><code>trait Additive[A]</code></p>

<ul>
<li>declares the method <code>or</code>

<ul>
<li>given <code>da</code>, somehow producing values of type <code>A</code>, and <code>da1</code>, somehow producing values of type <code>A</code>, <code>da or da1</code> should, somehow, produce the values produced by <code>da</code> or produce the values produced by <code>da1</code></li>
</ul>
</li>
<li>declares the method <code>++</code>, defined later in terms of (among others) <code>or</code></li>
</ul>


<p><em>Note:</em>
Do not think of <code>or</code> as an <em>exclusive</em> one, think of <code>or</code> as an <em>inclusive</em> one.</p>

<p><em>Note:</em>
<code>Additive[A]</code> also has a method <code>take</code></p>

<ul>
<li>when making use of <em>recursion</em>, <em>infinitely many values</em> can be produced</li>
</ul>


<h2>Polynomial data</h2>

<p><em>Polynomial data</em> are formalized by the <code>trait</code> below
as a combination of Multiplicative data and Additive data</p>

<figure class='code'><figcaption><span>Polynomial  (Polynomial.scala)</span> <a href='/downloads/code/Polynomial.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">PolynomialModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">MultiplicativeModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">AdditiveModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Polynomial</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Polynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Multiplicative</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Additive</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="o">++[</span><span class="kt">B</span><span class="o">](</span><span class="n">db</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span> <span class="kt">++</span> <span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">dl</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span> <span class="kt">++</span> <span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="n">da</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="nc">Left</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">dr</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span> <span class="kt">++</span> <span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="n">db</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">b</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="nc">Right</span><span class="o">(</span><span class="n">b</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="n">dl</span> <span class="n">or</span> <span class="n">dr</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait Polynomial[A]</code></p>

<ul>
<li>defines the method <code>++</code> in terms of <code>end</code> and <code>or</code></li>
</ul>


<h2>Polynomial data usage</h2>

<p>The code below defines some examples that make use of the polynomial data DSL</p>

<figure class='code'><figcaption><span>PolynomialUsage  (PolynomialUsage.scala)</span> <a href='/downloads/code/PolynomialUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">PolynomialUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.PolynomialModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">pm</span><span class="k">:</span> <span class="kt">PolynomialModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">pm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial01a</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">or</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="o">**</span> <span class="n">di</span> <span class="n">or</span> <span class="n">di</span> <span class="o">**</span> <span class="n">di</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial01b</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">di</span> <span class="o">**</span> <span class="n">di</span> <span class="n">or</span> <span class="n">di</span> <span class="o">**</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial03a</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">or</span> <span class="n">di</span><span class="o">)</span> <span class="o">**</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">or</span> <span class="n">di</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial03b</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">di</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">))</span> <span class="o">**</span> <span class="o">(</span><span class="n">di</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial02a</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">++</span> <span class="o">((</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">)</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="o">++</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">++</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="o">**</span> <span class="n">di</span> <span class="o">++</span> <span class="n">di</span> <span class="o">**</span> <span class="n">di</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial02b</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">))</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">di</span> <span class="o">**</span> <span class="n">di</span> <span class="o">++</span> <span class="n">di</span> <span class="o">**</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">++</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="o">++</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">**</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial04a</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">)</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">++</span> <span class="n">di</span><span class="o">)</span> <span class="o">**</span> <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="o">++</span> <span class="n">di</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">polynomial04b</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">)</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">di</span> <span class="o">++</span> <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">))</span> <span class="o">**</span> <span class="o">(</span><span class="n">di</span> <span class="o">++</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span> <span class="k">=</span> <span class="n">polynomial01a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span> <span class="k">=</span> <span class="n">polynomial01a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span> <span class="k">=</span> <span class="n">polynomial01b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example04</span> <span class="k">=</span> <span class="n">polynomial01b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example05</span> <span class="k">=</span> <span class="n">polynomial03a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example06</span> <span class="k">=</span> <span class="n">polynomial03a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example07</span> <span class="k">=</span> <span class="n">polynomial03b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example08</span> <span class="k">=</span> <span class="n">polynomial03b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example09</span> <span class="k">=</span> <span class="n">polynomial02a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example10</span> <span class="k">=</span> <span class="n">polynomial02a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example11</span> <span class="k">=</span> <span class="n">polynomial02b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example12</span> <span class="k">=</span> <span class="n">polynomial02b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example13</span> <span class="k">=</span> <span class="n">polynomial04a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example14</span> <span class="k">=</span> <span class="n">polynomial04a</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example15</span> <span class="k">=</span> <span class="n">polynomial04b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example16</span> <span class="k">=</span> <span class="n">polynomial04b</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">polynomial_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example01</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example02</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example03</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example04</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example05</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example06</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example07</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example08</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example09</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example10</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example11</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example12</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example13</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example14</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example15</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example16</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">nats</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="n">or</span> <span class="n">nats</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">fibs</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">or</span> <span class="n">fibs</span><span class="o">((</span><span class="n">i2</span><span class="o">,</span> <span class="o">(</span><span class="n">i1</span> <span class="o">+</span> <span class="n">i2</span><span class="o">)))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">recursion_and_take_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">lazy</span> <span class="k">val</span> <span class="n">firstTenNats</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">nats</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">take</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
</span><span class='line'>      <span class="k">lazy</span> <span class="k">val</span> <span class="n">firstNineFibs</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">fibs</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">)).</span><span class="n">take</span><span class="o">(</span><span class="mi">9</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">firstTenNats</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">firstNineFibs</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, think about expressions like <code>one(i1) ** one(i2) ++ (one(i1) ++ one(i2)) ** di ++ di ** di</code>, resp. <code>(one(i1) ++ di) ** (one(i2) ++ di)</code>
as generalizations of expressions like <code>a * b + (a + b) * x + x * x</code> resp. <code>(a + x) * (b + x)</code>
that also <em>produce accumulated data</em>.</p>

<p>The simplest <code>PolynomialModule</code> instance one can think of is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">ZeroOrOneModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Zero</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span> <span class="k">extends</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">One</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>ZeroOrOne[Z]</code> as a data source that produces <em>zero or one values</em>.</p>

<p>Given a <code>ZeroOrOne[Z]</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrOnePolynomialUsage  (ZeroOrOnePolynomialUsage.scala)</span> <a href='/downloads/code/ZeroOrOnePolynomialUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrOnePolynomialUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrOneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">pm</span><span class="k">:</span> <span class="kt">ZeroOrOneModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrOneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrOnePolynomialUsageInApp  (ZeroOrOnePolynomialUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrOnePolynomialUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrOnePolynomialUsage._</span>
</span><span class='line'>      <span class="n">polynomial_usage</span><span class="o">()</span>
</span><span class='line'>      <span class="n">recursion_and_take_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">Left</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">Left</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Right</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">Left</span><span class="o">((</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="nc">Left</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span><span class="nc">Left</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="nc">Left</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span><span class="nc">Left</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span><span class="nc">Right</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="nc">Left</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span><span class="nc">Left</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">0</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">0</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>A more complex <code>PolynomialModule</code> instance is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">ZeroOrMoreModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Zero</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span> <span class="k">extends</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">More</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a_n_u2da</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]))</span> <span class="k">extends</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>ZeroOrMore[Z]</code> as a data source that produces <em>zero or more values</em>.</p>

<p>Given a <code>ZeroOrMore[Z]</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrMorePolynomialUsage  (ZeroOrMorePolynomialUsage.scala)</span> <a href='/downloads/code/ZeroOrMorePolynomialUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrMorePolynomialUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">pm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrMorePolynomialUsageInApp  (ZeroOrMorePolynomialUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrMorePolynomialUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrMorePolynomialUsage._</span>
</span><span class='line'>      <span class="n">polynomial_usage</span><span class="o">()</span>
</span><span class='line'>      <span class="n">recursion_and_take_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">2</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">1</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Left</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">)))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Left</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">)))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="err">3</span><span class="o">)))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">)</span>,<span class="err">3</span><span class="o">)))</span> <span class="kt">Right</span><span class="o">((</span><span class="err">3</span>,<span class="err">3</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Left</span><span class="o">((</span><span class="err">3</span>,<span class="err">3</span><span class="o">)))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="err">3</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">))))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="err">3</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">))))</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">(</span><span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">3</span><span class="o">))</span> <span class="o">(</span><span class="kt">Right</span><span class="o">(</span><span class="err">3</span><span class="o">)</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">(</span><span class="kt">Right</span><span class="o">(</span><span class="err">3</span><span class="o">)</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">3</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="kt">Right</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="kt">Left</span><span class="o">(</span><span class="err">3</span><span class="o">)</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">3</span><span class="o">))</span> <span class="o">(</span><span class="kt">Left</span><span class="o">(</span><span class="err">3</span><span class="o">)</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">(</span><span class="kt">Right</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">3</span><span class="o">))</span> <span class="o">(</span><span class="kt">Right</span><span class="o">(</span><span class="err">1</span><span class="o">)</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="err">0</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">4</span> <span class="err">5</span> <span class="err">6</span> <span class="err">7</span> <span class="err">8</span> <span class="err">9</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="err">0</span> <span class="err">1</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">5</span> <span class="err">8</span> <span class="err">13</span> <span class="err">21</span> <span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Datasource</h2>

<p>You are, most probably, used to think of</p>

<ul>
<li><em>functions</em> in terms of <em>applying</em> them to <em>values</em> as in <code>a2b(a)</code> or, equivalently, <code>a2b apply a</code></li>
</ul>


<p>You can also think of</p>

<ul>
<li><em>values</em> in terms of <em>binding</em> them to <em>functions</em> as in <code>a bind a2b</code></li>
</ul>


<p>The method <code>bind</code> below, defined in terms of <code>apply</code>, formalizes binding</p>

<figure class='code'><figcaption><span>Bind  (Bind.scala)</span> <a href='/downloads/code/Bind.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">Bind</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">z</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">bind</span><span class="o">[</span><span class="kt">Y</span><span class="o">](</span><span class="n">z2y</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">Y</span><span class="o">)</span><span class="k">:</span> <span class="kt">Y</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">z2y</span> <span class="n">apply</span> <span class="n">z</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Data sources</em>, formalized by the <code>trait</code> below, generalize binding</p>

<figure class='code'><figcaption><span>Source  (Source.scala)</span> <a href='/downloads/code/Source.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">SourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">MultiplicativeModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">join</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">d_dz</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">d_dz</span> <span class="n">bnd</span> <span class="n">identity</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Multiplicative</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">d_a2b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span> <span class="k">=&gt;</span> <span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">d_a2b</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">a2b</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">a</span> <span class="n">bind</span> <span class="n">a2b</span> <span class="n">bind</span> <span class="n">one</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">switch</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">p_a</span><span class="k">:</span> <span class="kt">Predicate</span><span class="o">[</span><span class="kt">A</span><span class="o">])(</span><span class="n">t_a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])(</span><span class="n">f_a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="o">(</span><span class="n">a</span> <span class="n">bind</span> <span class="n">p_a</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="kc">true</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">a</span> <span class="n">bind</span> <span class="n">t_a2db</span>
</span><span class='line'>              <span class="k">case</span> <span class="kc">false</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">a</span> <span class="n">bind</span> <span class="n">f_a2db</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>where the <em>Predicate Type</em> <code>Predicate[Z]</code> is defined as</p>

<figure class='code'><figcaption><span>Predicate  (Predicate.scala)</span> <a href='/downloads/code/Predicate.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">type</span> <span class="kt">Predicate</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">A</span> <span class="k">=&gt;</span> <span class="nc">Boolean</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note:</em> We made use of <code>bind</code> just to show that it is as simple to use as <code>apply</code>.</p>

<p><code>trait SourceModule</code></p>

<ul>
<li>defines the function <code>join</code> in terms of <code>bnd</code></li>
</ul>


<p><code>trait Source[A]</code></p>

<ul>
<li>declares the method <code>bnd</code>

<ul>
<li>given <code>da</code>, somehow producing values of type <code>A</code>, and <code>a2db</code> of type <code>A =&gt; D[B]</code>, <code>da bnd a2db</code> should, somehow, using <code>a2b</code> and the values produced by <code>da</code>, produce values of type <code>B</code></li>
</ul>
</li>
<li>defines the method <code>and</code> in terms of <code>bnd</code> and <code>one</code></li>
<li>defines the method <code>switch</code> in terms of <code>bnd</code></li>
</ul>


<p>The definitions of <code>join</code> and <code>and</code> are the most natural ones you can possibly come up with to get the types right.</p>

<h2>About abstraction, power of expression and implementation flexibility</h2>

<p><em>abstraction</em></p>

<p><code>and</code> is more abstract than <code>bnd</code></p>

<ul>
<li><code>and</code> is defined interms of <code>bnd</code></li>
</ul>


<p><em>power of expression</em></p>

<p><code>bnd</code>, being less abstract, has more power of expression than <code>and</code></p>

<ul>
<li>When making use of <code>bnd</code>, values are immediately in scope from the outermost scope all the way down to the innermost scope.</li>
<li>When making use of <code>and</code>, values are only in scope at the innermost scope.</li>
</ul>


<p>The method <code>switch</code> illustrates this power of expression: <code>a</code> can be used to decide how to proceed.</p>

<p><em>implementation flexibility</em></p>

<p><code>and</code>, being more abstract, has more implementation flexibility than <code>bnd</code></p>

<ul>
<li>The definition of <code>and</code> is a <em>default</em> definition that can be overridden for specific implementations.</li>
</ul>


<h2>Datasource usage</h2>

<p>The code below defines some examples that make use of the datasource DSL</p>

<figure class='code'><figcaption><span>SourceUsage  (SourceUsage.scala)</span> <a href='/downloads/code/SourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">SourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.SourceModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">sm</span><span class="k">:</span> <span class="kt">SourceModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">sm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">source01</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="o">(</span><span class="n">z</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">source02</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">),</span> <span class="n">i3</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">one</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">x</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="o">((</span><span class="n">z</span><span class="o">,</span> <span class="n">y</span><span class="o">),</span> <span class="n">x</span><span class="o">)</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">source03</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">),</span> <span class="n">i3</span><span class="o">),</span> <span class="n">i4</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">one</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">x</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="n">one</span><span class="o">(</span><span class="n">i4</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                      <span class="n">w</span> <span class="k">=&gt;</span>
</span><span class='line'>                        <span class="o">(((</span><span class="n">z</span><span class="o">,</span> <span class="n">y</span><span class="o">),</span> <span class="n">x</span><span class="o">),</span> <span class="n">w</span><span class="o">)</span>
</span><span class='line'>                    <span class="o">}</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">source04</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="n">switch</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span> <span class="k">=</span> <span class="n">source01</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span> <span class="k">=</span> <span class="n">source02</span><span class="o">(((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span> <span class="k">=</span> <span class="n">source03</span><span class="o">((((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="mi">3</span><span class="o">),</span> <span class="mi">4</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example04</span> <span class="k">=</span> <span class="n">source04</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example05</span> <span class="k">=</span> <span class="n">source04</span><span class="o">(</span><span class="mi">11</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">source_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example01</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example02</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example03</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example04</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example05</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given a <code>One</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>OneSourceUsage  (OneSourceUsage.scala)</span> <a href='/downloads/code/OneSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">OneSourceUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.OneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">sm</span><span class="k">:</span> <span class="kt">OneModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">OneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>OneSourceUsageInApp  (OneSourceUsageInApp.scala)</span> <a href='/downloads/code/OneSourceUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.OneSourceUsage._</span>
</span><span class='line'>      <span class="n">source_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="mi">3</span><span class="o">),</span><span class="mi">4</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">5</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="mi">121</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Polynomial datasource</h2>

<p><em>Polynomial datasources</em> are formalized by the <code>trait</code> below
as a combination of Datasources and Polynomial data</p>

<figure class='code'><figcaption><span>PolynomialSource  (PolynomialSource.scala)</span> <a href='/downloads/code/PolynomialSource.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">PolynomialSourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">PolynomialModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">PolynomialSource</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">PolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Polynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">filter</span><span class="o">(</span><span class="n">pa</span><span class="k">:</span> <span class="kt">Predicate</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span><span class="o">.</span><span class="n">switch</span><span class="o">(</span><span class="n">pa</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">a</span> <span class="n">bind</span> <span class="n">one</span>
</span><span class='line'>        <span class="o">}</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="o">()</span> <span class="n">bind</span> <span class="n">zero</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait PolynomialSource[A]</code></p>

<ul>
<li>defines the method <code>filter</code> in terms of <code>switch</code>, <code>one</code> and <code>zero</code></li>
</ul>


<p>Again, the definition of <code>filter</code> is the most natural one you can possibly come up with to get the type right.</p>

<h2>Polynomial datasource usage</h2>

<p>The code below defines some examples that make use of the polynomial datasource DSL</p>

<figure class='code'><figcaption><span>PolynomialSourceUsage  (PolynomialSourceUsage.scala)</span> <a href='/downloads/code/PolynomialSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">PolynomialSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.PolynomialSourceModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">psm</span><span class="k">:</span> <span class="kt">PolynomialSourceModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">psm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">ps01</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">di</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">di</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                  <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>          <span class="o">})</span> <span class="n">or</span>
</span><span class='line'>            <span class="o">(</span><span class="n">di</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">})</span> <span class="n">or</span>
</span><span class='line'>            <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">})</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">ps02</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">))</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="o">(</span><span class="n">di</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">di</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                  <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>          <span class="o">})</span> <span class="o">++</span>
</span><span class='line'>            <span class="o">(</span><span class="n">di</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">++</span> <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">))</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">})</span> <span class="o">++</span>
</span><span class='line'>            <span class="o">(</span><span class="n">one</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">i</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">one</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">j</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>
</span><span class='line'>                <span class="o">}</span>
</span><span class='line'>            <span class="o">})</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">fps01</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">ps01</span><span class="o">((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">))(</span><span class="n">di</span><span class="o">).</span><span class="n">filter</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">i1</span> <span class="o">==</span> <span class="n">i2</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">fps02</span><span class="k">:</span> <span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">++</span> <span class="kt">Int</span><span class="o">))</span> <span class="kt">++</span> <span class="o">(</span><span class="kt">Int</span> <span class="kt">**</span> <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">di</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">ps02</span><span class="o">((</span><span class="n">i1</span><span class="o">,</span> <span class="n">i2</span><span class="o">))(</span><span class="n">di</span><span class="o">).</span><span class="n">filter</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">Right</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="kc">true</span>
</span><span class='line'>            <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="kc">false</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span> <span class="k">=</span> <span class="n">ps01</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span> <span class="k">=</span> <span class="n">ps01</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span> <span class="k">=</span> <span class="n">ps02</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example04</span> <span class="k">=</span> <span class="n">ps02</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example05</span> <span class="k">=</span> <span class="n">fps01</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example06</span> <span class="k">=</span> <span class="n">fps01</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example07</span> <span class="k">=</span> <span class="n">fps02</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example08</span> <span class="k">=</span> <span class="n">fps02</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">))(</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">polynomial_source_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example01</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example02</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example03</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example04</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example05</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example06</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example07</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">example08</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given a <code>ZeroOrOne</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrOnePolynomialSourceUsage  (ZeroOrOnePolynomialSourceUsage.scala)</span> <a href='/downloads/code/ZeroOrOnePolynomialSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrOnePolynomialSourceUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrOneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">psm</span><span class="k">:</span> <span class="kt">ZeroOrOneModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrOneModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrOnePolynomialSourceUsageInApp  (ZeroOrOnePolynomialSourceUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrOnePolynomialSourceUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrOnePolynomialSourceUsage._</span>
</span><span class='line'>      <span class="n">polynomial_source_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Right</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">Left</span><span class="o">((</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="nc">Right</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">))</span> <span class="o">}</span>
</span><span class='line'><span class="o">{</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given a <code>ZeroOrMore</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrMorePolynomialSourceUsage  (ZeroOrMorePolynomialSourceUsage.scala)</span> <a href='/downloads/code/ZeroOrMorePolynomialSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrMorePolynomialSourceUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">psm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrMorePolynomialSourceUsageInApp  (ZeroOrMorePolynomialSourceUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrMorePolynomialSourceUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrMorePolynomialSourceUsage._</span>
</span><span class='line'>      <span class="n">polynomial_source_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">1</span><span class="o">)</span> <span class="o">(</span><span class="err">3</span>,<span class="err">2</span><span class="o">)</span> <span class="o">(</span><span class="err">1</span>,<span class="err">2</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Left</span><span class="o">((</span><span class="err">3</span>,<span class="err">3</span><span class="o">)))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="err">3</span>,<span class="kt">Left</span><span class="o">(</span><span class="err">1</span><span class="o">))))</span> <span class="kt">Left</span><span class="o">(</span><span class="kt">Right</span><span class="o">((</span><span class="err">3</span>,<span class="kt">Right</span><span class="o">(</span><span class="err">2</span><span class="o">))))</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="o">(</span><span class="err">3</span>,<span class="err">3</span><span class="o">)</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span><span class='line'><span class="o">[</span> <span class="kt">Right</span><span class="o">((</span><span class="err">1</span>,<span class="err">2</span><span class="o">))</span> <span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Reducible data</h2>

<p><em>Reducible data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Reducible  (Reducible.scala)</span> <a href='/downloads/code/Reducible.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">ReducibleModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Reducible</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">R</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">identityReducer</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Reducible</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">reducedBy</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">a_r2_r</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">R</span><span class="o">])</span><span class="k">:</span> <span class="kt">R</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait ReducibleModule</code></p>

<ul>
<li>declares the type <code>Reducer[Z, R]</code></li>
<li>declares the reducer <code>identityReducer</code>

<ul>
<li>given <code>dz</code>, <code>dz reducedBy identityReducer</code> should reduce to <code>dz</code></li>
</ul>
</li>
</ul>


<p><code>trait Reducible[A]</code></p>

<ul>
<li>declares the method <code>reducedBy</code>

<ul>
<li>given <code>da</code>, somehow producing values of type <code>A</code>, and <code>a_r2_r</code>, somehow reducing those values to a result of type <code>R</code>, <code>da reducedBy a_r2_r</code> should reduce those values to that result</li>
</ul>
</li>
</ul>


<h2>Traversable data</h2>

<p><em>Traversable data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Traversable  (Traversable.scala)</span> <a href='/downloads/code/Traversable.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversableModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">ReducibleModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Traversable</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">MM</span> <span class="o">=</span> <span class="nc">MultiplicativeModule</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">lift</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">z2mmy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Y</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">swap</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">mm.D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">_</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">mm</span><span class="o">)(</span><span class="n">identity</span><span class="o">)(</span><span class="n">identityReducer</span><span class="o">)</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Traversable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Reducible</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">foreach</span><span class="o">[</span><span class="kt">B</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">a2mmdb</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">B</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">lift</span><span class="o">(</span><span class="n">mm</span><span class="o">)(</span><span class="n">a2mmdb</span><span class="o">)</span> <span class="n">andThen</span> <span class="n">da</span><span class="o">.</span><span class="n">reducedBy</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait TraversableModule</code></p>

<ul>
<li>defines the type <code>MM</code> as an alias of the type <code>MultiplicativeModule</code></li>
<li>declares the function <code>lift</code>

<ul>
<li>given an <code>mm</code> of type <code>MM</code> and a function <code>z2mmy</code> of type <code>Z =&gt; mm.D[Y]</code>, <code>lift</code> should <em>lift</em> a reducer of type <code>Reducer[Y, R]</code> to a reducer of type <code>Reducer[Z, mm.D[R]]</code></li>
</ul>
</li>
<li>defines the function <code>swap</code>, in terms of <code>foreach</code>, <code>identity</code> and <code>identityReducer</code></li>
</ul>


<p><code>trait Traversable[A]</code></p>

<ul>
<li>defines the method <code>foreach</code> in terms of <code>lift</code> and <code>reducedBy</code></li>
</ul>


<p>Again, the definitions of <code>swap</code> and <code>foreach</code> are the most natural ones you can possibly come up with to get the type right.</p>

<p><em>Traversable polynomial data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>TraversablePolynomial  (TraversablePolynomial.scala)</span> <a href='/downloads/code/TraversablePolynomial.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TraversableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">TraversablePolynomial</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">TraversablePolynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Polynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Traversable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Traversable datasources</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>TraversableSource  (TraversableSource.scala)</span> <a href='/downloads/code/TraversableSource.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversableSourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TraversableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">TraversableSource</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">TraversableSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Traversable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Traversable polynomial datasources</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>TraversablePolynomialSource  (TraversablePolynomialSource.scala)</span> <a href='/downloads/code/TraversablePolynomialSource.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversablePolynomialSourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">PolynomialSourceModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">TraversablePolynomialSource</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">TraversablePolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">TraversablePolynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">PolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Traversable polynomial data (and polynomial data) usage</h2>

<p>The code below defines some examples that make use of the traversable polynomial data (and polynomial data) DSL</p>

<figure class='code'><figcaption><span>TraversablePolynomialAndPolynomialUsage  (TraversablePolynomialAndPolynomialUsage.scala)</span> <a href='/downloads/code/TraversablePolynomialAndPolynomialUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversablePolynomialAndPolynomialUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.PolynomialModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">pm</span><span class="k">:</span> <span class="kt">PolynomialModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tp_p</span><span class="k">:</span> <span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">((</span><span class="n">pmd01</span><span class="o">,</span> <span class="n">pmd02</span><span class="o">),</span> <span class="n">pmd03</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">pmd01</span><span class="o">)</span> <span class="n">or</span> <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">pmd02</span><span class="o">)</span> <span class="n">or</span> <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">pmd03</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">p_tp</span><span class="k">:</span> <span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">tp_p</span> <span class="n">andThen</span> <span class="n">tpm</span><span class="o">.</span><span class="n">swap</span><span class="o">(</span><span class="n">pm</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span><span class="k">:</span> <span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">2</span><span class="o">)),</span> <span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span><span class="k">:</span> <span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pm</span><span class="o">.</span><span class="n">zero</span><span class="o">(()),</span> <span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">2</span><span class="o">)),</span> <span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span><span class="k">:</span> <span class="kt">pm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">pm</span><span class="o">.</span><span class="n">zero</span><span class="o">(())),</span> <span class="n">pm</span><span class="o">.</span><span class="n">zero</span><span class="o">(()))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm_in</span><span class="k">:</span> <span class="kt">tpm.In</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">pm_in</span><span class="k">:</span> <span class="kt">pm.In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">traversablePolynomial_and_polynomial_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_p</span><span class="o">(</span><span class="n">example01</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">p_tp</span><span class="o">(</span><span class="n">example01</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">pm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_p</span><span class="o">(</span><span class="n">example02</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">p_tp</span><span class="o">(</span><span class="n">example02</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">pm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_p</span><span class="o">(</span><span class="n">example03</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">p_tp</span><span class="o">(</span><span class="n">example03</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">pm_in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given <code>ZeroOrMore</code> and <code>ZeroOrOne</code> instances it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrMoreAndZeroOrOneUsage  (ZeroOrMoreAndZeroOrOneUsage.scala)</span> <a href='/downloads/code/ZeroOrMoreAndZeroOrOneUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrMoreAndZeroOrOneUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialAndPolynomialUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrOneModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">pm</span><span class="k">:</span> <span class="kt">ZeroOrOneModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrOneModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm_in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">pm_in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrMoreAndZeroOrOneUsageInApp  (ZeroOrMoreAndZeroOrOneUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrMoreAndZeroOrOneUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrMoreAndZeroOrOneUsage._</span>
</span><span class='line'>      <span class="n">traversablePolynomial_and_polynomial_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="o">]</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="o">}</span> <span class="o">{</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note</em> We swapped to a non-zero result if and only if all values are non-zero.</p>

<p>as such</p>

<ul>
<li><code>ZeroOrOne</code> could be used as a <em>success or failure</em> mechanism</li>
</ul>


<p>but</p>

<ul>
<li><code>ZeroOrOne</code> should be used for what it is meant for: <em>zero</em> or <em>one</em> values</li>
</ul>


<h2>Failure handling strategies</h2>

<p>Below are two failure handling strategies</p>

<ul>
<li><em>fail fast</em></li>
<li><em>fail slow</em> and <em>accumulate</em> failure information</li>
</ul>


<h2>Monoids</h2>

<p>Accumulation is modeled by the <em>monoid</em> concept.</p>

<p><em>Monoids</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Monoid  (Monoid.scala)</span> <a href='/downloads/code/Monoid.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">MonoidModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">M</span> <span class="k">&lt;:</span> <span class="kt">Monoid</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">neutral</span><span class="k">:</span> <span class="kt">M</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Monoid</span> <span class="o">{</span> <span class="n">m</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">operator</span><span class="o">(</span><span class="n">m1</span><span class="k">:</span> <span class="kt">M</span><span class="o">)</span><span class="k">:</span> <span class="kt">M</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait MonoidModule</code></p>

<ul>
<li>declares the type <code>M</code> as a subtype of <code>Monoid</code></li>
<li>declares the <code>neutral</code> element of type <code>M</code></li>
</ul>


<p><code>trait Monoid</code></p>

<ul>
<li>declares the method <code>operator</code>

<ul>
<li>given an element <code>m</code> of type <code>M</code> and an element <code>m1</code> of type <code>M</code>, <code>m operator m1</code> should be an element of type <code>M</code></li>
</ul>
</li>
</ul>


<p><em>Strings as monoids</em> are formalized by the instance below</p>

<figure class='code'><figcaption><span>StringMonoid  (StringMonoid.scala)</span> <a href='/downloads/code/StringMonoid.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">StringMonoidModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">MonoidModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">M</span> <span class="o">=</span> <span class="nc">StringMonoid</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">neutral</span> <span class="k">=</span>
</span><span class='line'>      <span class="nc">StringMonoid</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">StringMonoid</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</span><span class='line'>      <span class="k">extends</span> <span class="nc">Monoid</span> <span class="o">{</span> <span class="n">m</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">operator</span><span class="o">(</span><span class="n">m1</span><span class="k">:</span> <span class="kt">M</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'>        <span class="nc">StringMonoid</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${m.s} ${m1.s}&quot;</span><span class="o">)</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">s</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Failing data</h2>

<p><em>Failing data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Failing  (Failing.scala)</span> <a href='/downloads/code/Failing.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">FailingModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">HasZeroModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">mm</span><span class="k">:</span> <span class="kt">MonoidModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">mm._</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Failing</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">fail</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">zero</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">fail</span><span class="o">(</span><span class="n">neutral</span><span class="o">)</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Failing</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">HasZero</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait FailingModule</code></p>

<ul>
<li>declares a <code>mm</code> of type <code>MonoidModule</code> and does an appropriate import</li>
<li>declares the function <code>fail</code>

<ul>
<li>given an element <code>m</code> of type <code>M</code>, <code>fail(m)</code> should, somehow, not yield any values, but fail instead with failure information <code>m</code></li>
</ul>
</li>
<li>defines the function <code>zero</code> in terms of <code>fail</code> and <code>neutral</code></li>
</ul>


<p><em>Polynomial failing data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>PolynomialFailing  (PolynomialFailing.scala)</span> <a href='/downloads/code/PolynomialFailing.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">PolynomialFailingModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">PolynomialModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">FailingModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">PolynomialFailing</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">PolynomialFailing</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Polynomial</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Failing</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest <code>PolynomialFailingModule</code> instance one can think of is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">trait</span> <span class="nc">SuccessOrFailureModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Failure</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">m</span><span class="k">:</span> <span class="kt">M</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Success</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>SuccessOrFailure[Z]</code> as a data source that produces <em>one value</em> or <em>fails</em>.</p>

<p><em>Note:</em> <code>SuccessOrFailureModule</code> is a <code>trait</code> (<code>mm</code> still needs to be defined).</p>

<p>The simplest <code>SuccessOrFailureModule</code> instance one can think of is the following</p>

<figure class='code'><figcaption><span>StringSuccessOrFailureModule  (StringSuccessOrFailureModule.scala)</span> <a href='/downloads/code/StringSuccessOrFailureModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">StringSuccessOrFailureModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SuccessOrFailureModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">mm</span><span class="k">:</span> <span class="kt">StringMonoidModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">StringMonoidModule</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Traversable polynomial data (and polynomial failing data) usage</h2>

<p>The code below defines some examples that make use of the traversable polynomial data (and polynomial failing data) DSL</p>

<figure class='code'><figcaption><span>TraversablePolynomialAndPolynomialFailingUsage  (TraversablePolynomialAndPolynomialFailingUsage.scala)</span> <a href='/downloads/code/TraversablePolynomialAndPolynomialFailingUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">TraversablePolynomialAndPolynomialFailingUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.PolynomialFailingModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">pfm</span><span class="k">:</span> <span class="kt">PolynomialFailingModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tp_pf</span><span class="k">:</span> <span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">((</span><span class="n">mfmd01</span><span class="o">,</span> <span class="n">mfmd02</span><span class="o">),</span> <span class="n">mfmd03</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">mfmd01</span><span class="o">)</span> <span class="n">or</span> <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">mfmd02</span><span class="o">)</span> <span class="n">or</span> <span class="n">tpm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">mfmd03</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">pf_tp</span><span class="k">:</span> <span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">tp_pf</span> <span class="n">andThen</span> <span class="n">tpm</span><span class="o">.</span><span class="n">swap</span><span class="o">(</span><span class="n">pfm</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">m1</span><span class="k">:</span> <span class="kt">pfm.mm.M</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">m2</span><span class="k">:</span> <span class="kt">pfm.mm.M</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example01</span><span class="k">:</span> <span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">2</span><span class="o">)),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example02</span><span class="k">:</span> <span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pfm</span><span class="o">.</span><span class="n">fail</span><span class="o">(</span><span class="n">m1</span><span class="o">),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">2</span><span class="o">)),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">example03</span><span class="k">:</span> <span class="kt">pfm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">**</span> <span class="n">pfm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">((</span><span class="n">pfm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">fail</span><span class="o">(</span><span class="n">m1</span><span class="o">)),</span> <span class="n">pfm</span><span class="o">.</span><span class="n">fail</span><span class="o">(</span><span class="n">m2</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm_in</span><span class="k">:</span> <span class="kt">tpm.In</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">mfm_in</span><span class="k">:</span> <span class="kt">pfm.In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">traversablePolynomial_and_multiplicativeFailing_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_pf</span><span class="o">(</span><span class="n">example01</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">pf_tp</span><span class="o">(</span><span class="n">example01</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">mfm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_pf</span><span class="o">(</span><span class="n">example02</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">pf_tp</span><span class="o">(</span><span class="n">example02</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">mfm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">tp_pf</span><span class="o">(</span><span class="n">example03</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">tpm_in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">pf_tp</span><span class="o">(</span><span class="n">example03</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">mfm_in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given <code>ZeroOrMore</code> and <code>StringSuccessOrFailure</code> instances it is possible to define</p>

<figure class='code'><figcaption><span>ZeroOrMoreAndStringSuccessOrFailureUsage  (ZeroOrMoreAndStringSuccessOrFailureUsage.scala)</span> <a href='/downloads/code/ZeroOrMoreAndStringSuccessOrFailureUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrMoreAndStringSuccessOrFailureUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialAndPolynomialFailingUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.StringSuccessOrFailureModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">pfm</span><span class="k">:</span> <span class="kt">StringSuccessOrFailureModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">StringSuccessOrFailureModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">pfm.mm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">m1</span> <span class="k">=</span> <span class="nc">StringMonoid</span><span class="o">(</span><span class="s">&quot;failure1&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">m2</span> <span class="k">=</span> <span class="nc">StringMonoid</span><span class="o">(</span><span class="s">&quot;failure2&quot;</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm_in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">mfm_in</span> <span class="k">=</span> <span class="o">()</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>ZeroOrMoreAndStringSuccessOrFailureUsageInApp  (ZeroOrMoreAndStringSuccessOrFailureUsageInApp.scala)</span> <a href='/downloads/code/ZeroOrMoreAndStringSuccessOrFailureUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.ZeroOrMoreAndStringSuccessOrFailureUsage._</span>
</span><span class='line'>      <span class="n">traversablePolynomial_and_multiplicativeFailing_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the examples above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="o">]</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="kt">failure1</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="n">failure1</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="kt">failure1</span> <span class="o">}</span> <span class="o">{</span> <span class="kt">failure2</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="n">failure1</span> <span class="n">failure2</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>If, as suggested in the code of the actual implementation (not given yet), you comment out the <em>overriding definition</em> of <code>and</code> and make use of the <em>default definition</em> instead, then this results in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="o">]</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="kt">failure1</span> <span class="o">}</span> <span class="o">{</span> <span class="err">2</span> <span class="o">}</span> <span class="o">{</span> <span class="err">3</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="n">failure1</span> <span class="o">}</span>
</span><span class='line'><span class="o">[</span> <span class="o">{</span> <span class="err">1</span> <span class="o">}</span> <span class="o">{</span> <span class="kt">failure1</span> <span class="o">}</span> <span class="o">{</span> <span class="kt">failure2</span> <span class="o">}</span> <span class="o">]</span>
</span><span class='line'><span class="o">{</span> <span class="n">failure1</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>What is the moral of this story:</em></p>

<ul>
<li><code>and</code>, being more abstract than <code>bnd</code>, has more implementation flexibility</li>
</ul>


<p>The default fail fast strategy implementation can (but does not have to) be overridden by a fail slow and accumulate strategy implementation.</p>

<h2>Stateful data</h2>

<p><em>Stateful data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Stateful  (Stateful.scala)</span> <a href='/downloads/code/Stateful.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">StatefulModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">S</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Stateful</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">get</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">S</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">set</span><span class="k">:</span> <span class="kt">S</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">exec</span><span class="k">:</span> <span class="o">(</span><span class="kt">S</span> <span class="o">=&gt;</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Stateful</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait StatefulModule</code></p>

<ul>
<li>declares a type <code>S</code>

<ul>
<li><code>S</code> represents <em>state</em></li>
</ul>
</li>
<li>declares the function <code>get</code>

<ul>
<li><code>get(())</code> should, somehow, produce the current state</li>
</ul>
</li>
<li>declares the function <code>set</code>

<ul>
<li><code>set(s)</code> should, somehow, set the current state (and produce <code>()</code>)</li>
</ul>
</li>
<li>declares the function <code>exec</code>

<ul>
<li>given a function <code>s2s</code>, <code>exec(s2s)</code> should, somehow, transform the current state <code>s</code> to <code>s2s(s)</code> (and produce <code>()</code>)</li>
</ul>
</li>
</ul>


<h2>Stateful data source</h2>

<p><em>Stateful datasources</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>StatefulSource  (StatefulSource.scala)</span> <a href='/downloads/code/StatefulSource.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">StatefulSourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">StatefulModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">StatefulSource</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">exec</span><span class="k">:</span> <span class="o">(</span><span class="kt">S</span> <span class="o">=&gt;</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">s2s</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">get</span><span class="o">(())</span> <span class="n">bnd</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">set</span><span class="o">(</span><span class="n">s2s</span><span class="o">(</span><span class="n">s</span><span class="o">))</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">StatefulSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Stateful</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait StatefulSourceModule</code></p>

<ul>
<li>defines the function <code>exec</code> in terms of <code>get</code>, <code>set</code> and <code>bnd</code></li>
</ul>


<h2>Stateful datasource usage</h2>

<p>The code below defines some example that makes use of the stateful datasource DSL.
It deals with a simple &ldquo;coin and candy&rdquo; state machine.</p>

<figure class='code'><figcaption><span>StatefulSourceUsage  (StatefulSourceUsage.scala)</span> <a href='/downloads/code/StatefulSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">StatefulSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">TraversablePolynomialModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.StatefulSourceModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">object</span> <span class="nc">Status</span> <span class="k">extends</span> <span class="nc">Enumeration</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">val</span> <span class="nc">FREE</span><span class="o">,</span> <span class="nc">BUSY</span> <span class="k">=</span> <span class="nc">Value</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">object</span> <span class="nc">Action</span> <span class="k">extends</span> <span class="nc">Enumeration</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">val</span> <span class="nc">COIN_IN</span><span class="o">,</span> <span class="nc">CANDY_OUT</span> <span class="k">=</span> <span class="nc">Value</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Status.</span><span class="o">{</span> <span class="nc">FREE</span><span class="o">,</span> <span class="nc">BUSY</span> <span class="o">}</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Action.</span><span class="o">{</span> <span class="nc">COIN_IN</span><span class="o">,</span> <span class="nc">CANDY_OUT</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">Machine</span><span class="o">(</span><span class="n">status</span><span class="k">:</span> <span class="kt">Status.Value</span><span class="o">,</span> <span class="n">candies</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">coins</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">acceptsCoinIn</span> <span class="k">=</span> <span class="n">candies</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">status</span> <span class="o">==</span> <span class="nc">FREE</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">acceptsCandyOut</span> <span class="k">=</span> <span class="n">candies</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">status</span> <span class="o">==</span> <span class="nc">BUSY</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">ssm</span><span class="k">:</span> <span class="kt">StatefulSourceModule</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">type</span> <span class="kt">S</span> <span class="o">=</span> <span class="kt">Machine</span>
</span><span class='line'>      <span class="k">type</span> <span class="kt">In</span> <span class="o">=</span> <span class="n">S</span>
</span><span class='line'>      <span class="k">type</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="n">S</span> <span class="o">**</span> <span class="n">Z</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">ssm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">executeAction</span><span class="k">:</span> <span class="kt">Action.Value</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">action</span> <span class="k">=&gt;</span> <span class="n">exec</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">machine</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">action</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">COIN_IN</span> <span class="k">if</span> <span class="o">(</span><span class="n">machine</span><span class="o">.</span><span class="n">acceptsCoinIn</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="nc">Machine</span><span class="o">(</span><span class="nc">BUSY</span><span class="o">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">candies</span><span class="o">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">coins</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span><span class='line'>            <span class="k">case</span> <span class="nc">CANDY_OUT</span> <span class="k">if</span> <span class="o">(</span><span class="n">machine</span><span class="o">.</span><span class="n">acceptsCandyOut</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="nc">Machine</span><span class="o">(</span><span class="nc">FREE</span><span class="o">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">candies</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">coins</span><span class="o">)</span>
</span><span class='line'>            <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">machine</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">initialMachine</span><span class="k">:</span> <span class="kt">Machine</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">tpm.Reducer</span><span class="o">[</span><span class="kt">Unit</span>, <span class="kt">Unit</span><span class="o">]</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">actions</span><span class="k">:</span> <span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Action.Value</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">ss</span><span class="k">:</span> <span class="kt">ssm.D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">actions</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">ssm</span><span class="o">)(</span><span class="n">executeAction</span><span class="o">)(</span><span class="n">reducer</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">stateful_source_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">val</span> <span class="n">finalMachine</span><span class="k">:</span> <span class="kt">Machine</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">initialMachine</span><span class="o">).</span><span class="n">_1</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">finalMachine</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest stateful <code>Runnable</code> implementation is the following</p>

<figure class='code'><figcaption><span>StatefulRunnableModule  (StatefulRunnableModule.scala)</span> <a href='/downloads/code/StatefulRunnableModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">StatefulRunnableModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">StatefulRunnable</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">S</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">In</span> <span class="o">=</span> <span class="n">S</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="n">S</span> <span class="o">**</span> <span class="n">Z</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">StatefulRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest <code>StatefulSourceModule</code> instance one can think of is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">StateModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">case</span> <span class="k">class</span> <span class="nc">State</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">s_2_sna</span><span class="k">:</span> <span class="kt">S</span> <span class="o">=&gt;</span> <span class="n">S</span> <span class="o">**</span> <span class="n">A</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>State[Z]</code> as a data source that produces, <em>maintaining state while producing</em>, one value.</p>

<p>Given a <code>State[Z]</code> instance it is possible to define</p>

<figure class='code'><figcaption><span>StateUsage  (StateUsage.scala)</span> <a href='/downloads/code/StateUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">StateUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">StatefulSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.StateModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">object</span> <span class="nc">MachineStateModule</span>
</span><span class='line'>      <span class="k">extends</span> <span class="nc">StateModule</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">type</span> <span class="kt">S</span> <span class="o">=</span> <span class="nc">Machine</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">ssm</span><span class="k">:</span> <span class="kt">MachineStateModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">MachineStateModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">ssm._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Status.</span><span class="o">{</span> <span class="nc">FREE</span><span class="o">,</span> <span class="nc">BUSY</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">initialMachine</span> <span class="k">=</span> <span class="nc">Machine</span><span class="o">(</span><span class="nc">FREE</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Action.</span><span class="o">{</span> <span class="nc">COIN_IN</span><span class="o">,</span> <span class="nc">CANDY_OUT</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">tpm.one</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">actions</span><span class="k">:</span> <span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Action.Value</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">one</span><span class="o">(</span><span class="nc">COIN_IN</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="nc">CANDY_OUT</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="nc">COIN_IN</span><span class="o">)</span> <span class="n">or</span> <span class="n">one</span><span class="o">(</span><span class="nc">CANDY_OUT</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">tpm.Reducer</span><span class="o">[</span><span class="kt">Unit</span>, <span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">({</span> <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">()</span> <span class="o">},</span> <span class="o">{</span> <span class="k">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">()</span> <span class="o">})</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>StateUsageInApp  (StateUsageInApp.scala)</span> <a href='/downloads/code/StateUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.StateUsage._</span>
</span><span class='line'>      <span class="n">stateful_source_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the example above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="nc">Machine</span><span class="o">(</span><span class="nc">FREE</span><span class="o">,</span><span class="mi">18</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Asynchronous data</h2>

<p><em>Asynchronous data</em> are formalized by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>Asynchronous  (Asynchronous.scala)</span> <a href='/downloads/code/Asynchronous.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">AsynchronousModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">Asynchronous</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">async</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">Z</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">Asynchronous</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>trait AsynchronousModule</code></p>

<ul>
<li>declares the function <code>async</code>

<ul>
<li>given <code>u2z</code>, <code>async(u2z)</code> should produce <code>u2z(())</code> <em>asynchronously</em></li>
</ul>
</li>
</ul>


<h2>Asynchronous data source</h2>

<p><em>Asynchronous datasources</em> are declared by the <code>trait</code> below</p>

<figure class='code'><figcaption><span>AsynchronousSource  (AsynchronousSource.scala)</span> <a href='/downloads/code/AsynchronousSource.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">AsynchronousSourceModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">SourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">AsynchronousModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">AsynchronousSource</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">AsynchronousSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Source</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">Asynchronous</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Asynchronous datasource usage</h2>

<p>The code below defines some examples that make use of the asynchronous datasource DSL</p>

<figure class='code'><figcaption><span>AsynchronousSourceUsage  (AsynchronousSourceUsage.scala)</span> <a href='/downloads/code/AsynchronousSourceUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">AsynchronousSourceUsage</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Lib.AsynchronousSourceModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">TraversablePolynomialModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">tpm.one</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">asm</span><span class="k">:</span> <span class="kt">AsynchronousSourceModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">asm.async</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">java.lang.Thread.sleep</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">sleepVerbose</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span><span class="o">).</span><span class="n">toList</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">x</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">sleep</span><span class="o">(</span><span class="mi">500</span><span class="o">)</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">10</span><span class="o">)</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;\n${i} finished\n&quot;</span><span class="o">)</span>
</span><span class='line'>            <span class="k">else</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${i} &quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">i</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">math._</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">randomSleep</span><span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">sleep</span><span class="o">(</span><span class="n">round</span><span class="o">(</span><span class="n">timeOut</span> <span class="o">*</span> <span class="n">random</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">randomSleepVerbose</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span><span class="o">).</span><span class="n">toList</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">x</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">randomSleep</span><span class="o">(</span><span class="mi">500</span><span class="o">)</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">10</span><span class="o">)</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;\n${i} finished\n&quot;</span><span class="o">)</span>
</span><span class='line'>            <span class="k">else</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${i} &quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">i</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">manySleepVerbose</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Unit</span> <span class="k">=&gt;</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">n</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">sleepVerbose</span><span class="o">(</span><span class="n">n</span><span class="o">))</span> <span class="n">or</span> <span class="n">manySleepVerbose</span><span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">manyRandomSleepVerbose</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Unit</span> <span class="k">=&gt;</span> <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">n</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">one</span><span class="o">(</span><span class="n">randomSleepVerbose</span><span class="o">(</span><span class="n">n</span><span class="o">))</span> <span class="n">or</span> <span class="n">manyRandomSleepVerbose</span><span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">asm.In</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tp_as01</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">asm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">manySleepVerbose</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="n">end</span> <span class="n">async</span> <span class="n">take</span> <span class="o">(</span><span class="mi">8</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">as_tp01</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">asm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">tp_as01</span> <span class="n">andThen</span> <span class="n">tpm</span><span class="o">.</span><span class="n">swap</span><span class="o">(</span><span class="n">asm</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">tp_as02</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">tpm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">asm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">manyRandomSleepVerbose</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="n">end</span> <span class="n">async</span> <span class="n">take</span> <span class="o">(</span><span class="mi">8</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">as_tp02</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="n">asm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">tpm.D</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">tp_as02</span> <span class="n">andThen</span> <span class="n">tpm</span><span class="o">.</span><span class="n">swap</span><span class="o">(</span><span class="n">asm</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="n">asynchronous_source_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">as_tp01</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>      <span class="n">println</span><span class="o">(</span><span class="n">as_tp02</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest asynchronous <code>Runnable</code> implementation is the following</p>

<figure class='code'><figcaption><span>AsynchronousRunnableModule  (AsynchronousRunnableModule.scala)</span> <a href='/downloads/code/AsynchronousRunnableModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">AsynchronousRunnableModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">RunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">&lt;:</span> <span class="nc">AsynchronousRunnable</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">In</span> <span class="o">=</span> <span class="nc">ExecutorService</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="n">Z</span>
</span><span class='line'>    <span class="k">trait</span> <span class="nc">AsynchronousRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">Runnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The simplest <code>AsynchronousSourceModule</code> instance one can think of is one along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">AsyncModule</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="k">case</span> <span class="k">class</span> <span class="nc">Async</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">es_2_sfa</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think of <code>Async[Z]</code> as a data source that, making use of an <em>executor service</em>, produces one value <em>asynchronously</em>.</p>

<p>Given a <code>Async[Z]</code> instance it is possible to a define</p>

<figure class='code'><figcaption><span>AsyncUsage  (AsyncUsage.scala)</span> <a href='/downloads/code/AsyncUsage.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">AsyncUsage</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">AsynchronousSourceUsage</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">Instances.AsyncModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">tpm</span><span class="k">:</span> <span class="kt">ZeroOrMoreModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">asm</span><span class="k">:</span> <span class="kt">AsyncModule.</span><span class="k">type</span> <span class="o">=</span> <span class="nc">AsyncModule</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">import</span> <span class="nn">java.util.concurrent.ExecutorService</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">java.util.concurrent.Executors</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">val</span> <span class="n">in</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=</span>
</span><span class='line'>      <span class="nc">Executors</span><span class="o">.</span><span class="n">newScheduledThreadPool</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">asynchronous_source_usage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">super</span><span class="o">.</span><span class="n">asynchronous_source_usage</span>
</span><span class='line'>      <span class="n">in</span><span class="o">.</span><span class="n">shutdown</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>and use it as follows</p>

<figure class='code'><figcaption><span>AsyncUsageInApp  (AsyncUsageInApp.scala)</span> <a href='/downloads/code/AsyncUsageInApp.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>    <span class="o">{</span>
</span><span class='line'>      <span class="k">import</span> <span class="nn">Usage.AsyncUsage._</span>
</span><span class='line'>      <span class="n">asynchronous_source_usage</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running the example above would then result in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">1</span> <span class="mi">7</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">8</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">7</span>
</span><span class='line'><span class="mi">3</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">6</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">8</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">2</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">1</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">7</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">5</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">4</span> <span class="n">finished</span>
</span><span class='line'><span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">4</span> <span class="err">5</span> <span class="err">6</span> <span class="err">7</span> <span class="err">8</span> <span class="o">]</span>
</span><span class='line'><span class="mi">7</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">8</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">5</span> <span class="mi">1</span> <span class="mi">7</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">8</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">7</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">5</span> <span class="mi">3</span>
</span><span class='line'><span class="mi">6</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">7</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span>
</span><span class='line'><span class="mi">3</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">5</span> <span class="mi">7</span> <span class="mi">2</span> <span class="mi">8</span>
</span><span class='line'><span class="mi">8</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">4</span> <span class="mi">1</span> <span class="mi">5</span> <span class="mi">7</span>
</span><span class='line'><span class="mi">2</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">5</span> <span class="mi">4</span>
</span><span class='line'><span class="mi">1</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">7</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">5</span> <span class="mi">4</span>
</span><span class='line'><span class="mi">4</span> <span class="n">finished</span>
</span><span class='line'>
</span><span class='line'><span class="mi">5</span> <span class="n">finished</span>
</span><span class='line'><span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">4</span> <span class="err">5</span> <span class="err">6</span> <span class="err">7</span> <span class="err">8</span> <span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>If, as suggested in the code of the actual implementation (not given yet), you comment out the <em>overriding definition</em> of <code>and</code> and make use of the <em>default definition</em> instead, then this results in something along the following lines</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</span><span class='line'><span class="mi">1</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span>
</span><span class='line'><span class="mi">2</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span>
</span><span class='line'><span class="mi">3</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</span><span class='line'><span class="mi">4</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span>
</span><span class='line'><span class="mi">5</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span>
</span><span class='line'><span class="mi">6</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span>
</span><span class='line'><span class="mi">7</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
</span><span class='line'><span class="mi">8</span> <span class="n">finished</span>
</span><span class='line'><span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">4</span> <span class="err">5</span> <span class="err">6</span> <span class="err">7</span> <span class="err">8</span> <span class="o">]</span>
</span><span class='line'><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</span><span class='line'><span class="mi">1</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span>
</span><span class='line'><span class="mi">2</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span>
</span><span class='line'><span class="mi">3</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</span><span class='line'><span class="mi">4</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span>
</span><span class='line'><span class="mi">5</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span> <span class="mi">6</span>
</span><span class='line'><span class="mi">6</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span> <span class="mi">7</span>
</span><span class='line'><span class="mi">7</span> <span class="n">finished</span>
</span><span class='line'><span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
</span><span class='line'><span class="mi">8</span> <span class="n">finished</span>
</span><span class='line'><span class="o">[</span> <span class="err">1</span> <span class="err">2</span> <span class="err">3</span> <span class="err">4</span> <span class="err">5</span> <span class="err">6</span> <span class="err">7</span> <span class="err">8</span> <span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>What is the moral of this story:</em></p>

<ul>
<li><code>and</code>, being more abstract than <code>bnd</code>, has more implementation flexibility</li>
</ul>


<p>The default <em>sequential</em> implementation can (but does not have to) be overridden by a <em>concurrent</em> implementation.</p>

<h2>Implementations</h2>

<p>We still did not fully define any concrete instances yet.</p>

<h2>OneModule</h2>

<p><code>OneModule</code> is a <code>TraversableSourceModule</code></p>

<figure class='code'><figcaption><span>OneModule  (OneModule.scala)</span> <a href='/downloads/code/OneModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">OneModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversableSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TrivialRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">One</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">One</span><span class="o">(</span><span class="n">z</span><span class="o">)</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="n">Z</span> <span class="k">=&gt;</span> <span class="n">R</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">identityReducer</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">one</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">lift</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">z2mmdy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Y</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">y2r</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">z2mmdr</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">z2mmdy</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">y2r</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">z2mmdr</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">One</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span>
</span><span class='line'>      <span class="k">extends</span> <span class="nc">TraversableSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">reducedBy</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">a_r2_r</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">R</span><span class="o">])</span><span class="k">:</span> <span class="kt">R</span> <span class="o">=</span> <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">One</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="n">a2r</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">a2r</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="n">a2db</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2s</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">s</span><span class="s">&quot; ${a}&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">s</span><span class="s">&quot;{${da reducedBy a2s} }&quot;</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ZeroOrOneModule</h2>

<p><code>ZeroOrOneModule</code> is a <code>TraversablePolynomialSourceModule</code></p>

<figure class='code'><figcaption><span>ZeroOrOneModule  (ZeroOrOneModule.scala)</span> <a href='/downloads/code/ZeroOrOneModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrOneModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TrivialRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">zero</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">Zero</span><span class="o">()</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">One</span><span class="o">(</span><span class="n">z</span><span class="o">)</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="nc">Unit</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">**</span> <span class="o">(</span><span class="n">Z</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">identityReducer</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>      <span class="o">(</span><span class="n">zero</span><span class="o">,</span> <span class="n">one</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">lift</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">z2mmdy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Y</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">u2r</span><span class="o">,</span> <span class="n">y2r</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2mmdr</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">mm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">u2r</span><span class="o">(()))</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">z2mmdr</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">z2mmdy</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">y2r</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="o">(</span><span class="n">u2mmdr</span><span class="o">,</span> <span class="n">z2mmdr</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">TraversablePolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">take</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">reducedBy</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">a_r2_r</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">R</span><span class="o">])</span><span class="k">:</span> <span class="kt">R</span> <span class="o">=</span> <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Zero</span><span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="n">u2r</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">u2r</span><span class="o">(())</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">One</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">a2r</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">a2r</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="o">(</span><span class="n">zero</span><span class="o">[</span><span class="kt">B</span><span class="o">],</span> <span class="n">a2db</span><span class="o">)</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">or</span><span class="o">(</span><span class="n">da1</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2da</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">da1</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2da</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="o">(</span><span class="n">u2da</span><span class="o">,</span> <span class="n">a2da</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2s</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2s</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">s</span><span class="s">&quot; ${a}&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">s</span><span class="s">&quot;{${da reducedBy (u2s, a2s)} }&quot;</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Zero</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span> <span class="k">extends</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">One</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">ZeroOrOne</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ZeroOrMoreModule</h2>

<p><code>ZeroOrMoreModule</code> is a <code>TraversablePolynomialSourceModule</code></p>

<figure class='code'><figcaption><span>ZeroOrMoreModule  (ZeroOrMoreModule.scala)</span> <a href='/downloads/code/ZeroOrMoreModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">ZeroOrMoreModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TrivialRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">zero</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">Zero</span><span class="o">()</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">More</span><span class="o">((</span><span class="n">z</span><span class="o">,</span> <span class="n">zero</span><span class="o">))</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">def</span> <span class="n">more</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="o">(</span><span class="kt">Z</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]))</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">z_n_u2dz</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="nc">More</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">z_n_u2dz</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="nc">Unit</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">**</span> <span class="o">((</span><span class="n">Z</span> <span class="o">**</span> <span class="o">(</span><span class="nc">Unit</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">))</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">identityReducer</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="o">(</span><span class="n">zero</span><span class="o">,</span> <span class="n">more</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">lift</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">z2mmdy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Y</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">u2r</span><span class="o">,</span> <span class="n">y_n_u2r__2__r</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2mmdr</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">mm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">u2r</span><span class="o">(()))</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">z_n_u2mmdr__2__mmdr</span><span class="k">:</span> <span class="o">(</span><span class="kt">Z</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]))</span> <span class="k">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">(</span><span class="n">z</span><span class="o">,</span> <span class="n">u2mmdr</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">z2mmdy</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="n">and</span> <span class="o">(</span>
</span><span class='line'>              <span class="n">u2mmdr</span><span class="o">(())</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">r</span> <span class="k">=&gt;</span>
</span><span class='line'>                  <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                    <span class="n">y_n_u2r__2__r</span><span class="o">((</span><span class="n">y</span><span class="o">,</span> <span class="o">{</span> <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="n">r</span> <span class="o">}))</span>
</span><span class='line'>              <span class="o">})</span>
</span><span class='line'>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="o">(</span><span class="n">u2mmdr</span><span class="o">,</span> <span class="n">z_n_u2mmdr__2__mmdr</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">TraversablePolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">take</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="nc">Zero</span><span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">zero</span><span class="o">(())</span>
</span><span class='line'>          <span class="k">case</span> <span class="nc">More</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">u2da</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
</span><span class='line'>              <span class="n">more</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="o">{</span> <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="n">u2da</span><span class="o">(()).</span><span class="n">take</span><span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">}))</span>
</span><span class='line'>            <span class="k">else</span>
</span><span class='line'>              <span class="n">zero</span><span class="o">(())</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a_n_u2db__2__db</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]))</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">u2db</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">a2db</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="n">or</span> <span class="n">u2db</span><span class="o">(())</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="o">((</span><span class="n">zero</span><span class="o">[</span><span class="kt">B</span><span class="o">],</span> <span class="n">a_n_u2db__2__db</span><span class="o">))</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">or</span><span class="o">(</span><span class="n">da1</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2da</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">da1</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="o">(</span><span class="n">u2da</span><span class="o">,</span> <span class="n">more</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2s</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a_n_u2s__2__s</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">String</span><span class="o">))</span> <span class="k">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">s</span><span class="s">&quot; ${a}${s(())}&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">s</span><span class="s">&quot;[${da reducedBy (u2s, a_n_u2s__2__s)} ]&quot;</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">reducedBy</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">a_r2_r</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">R</span><span class="o">])</span><span class="k">:</span> <span class="kt">R</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="nc">Zero</span><span class="o">()</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="o">(</span><span class="n">u2r</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">u2r</span><span class="o">(())</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>          <span class="k">case</span> <span class="nc">More</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">u2da</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="o">(</span><span class="n">u2r</span><span class="o">,</span> <span class="n">a_n_u2r__2__r</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">a_n_u2r__2__r</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="o">{</span> <span class="k">case</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="n">u2da</span><span class="o">(()).</span><span class="n">reducedBy</span><span class="o">((</span><span class="n">u2r</span><span class="o">,</span> <span class="n">a_n_u2r__2__r</span><span class="o">))</span> <span class="o">}))</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">In</span><span class="o">)</span><span class="k">:</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Zero</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span> <span class="k">extends</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">More</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a_n_u2da</span><span class="k">:</span> <span class="kt">A</span> <span class="kt">**</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]))</span> <span class="k">extends</span> <span class="nc">ZeroOrMore</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>SuccessOrFailureModule</h2>

<p><code>SuccessOrFailureModule</code> is a <code>TraversablePolynomialSourceModule</code> and a <code>PolynomialFailingModule</code></p>

<figure class='code'><figcaption><span>SuccessOrFailureModule  (SuccessOrFailureModule.scala)</span> <a href='/downloads/code/SuccessOrFailureModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">SuccessOrFailureModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">TraversablePolynomialSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">PolynomialFailingModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">TrivialRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">import</span> <span class="nn">mm._</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">fail</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">m</span> <span class="k">=&gt;</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span> <span class="nc">Success</span><span class="o">(</span><span class="n">z</span><span class="o">)</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">M</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">**</span> <span class="o">(</span><span class="n">Z</span> <span class="k">=&gt;</span> <span class="n">R</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">identityReducer</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="o">(</span><span class="n">fail</span><span class="o">,</span> <span class="n">one</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">lift</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">Y</span>, <span class="kt">R</span><span class="o">](</span><span class="n">mm</span><span class="k">:</span> <span class="kt">MM</span><span class="o">)(</span><span class="n">z2mmdy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">Y</span>, <span class="kt">R</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Reducer</span><span class="o">[</span><span class="kt">Z</span>, <span class="kt">mm.D</span><span class="o">[</span><span class="kt">R</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="o">(</span><span class="n">m2r</span><span class="o">,</span> <span class="n">y2r</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">m2mmdr</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">m</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">mm</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="n">m2r</span><span class="o">(</span><span class="n">m</span><span class="o">))</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">z2mmdr</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">mm</span><span class="o">.</span><span class="n">D</span><span class="o">[</span><span class="kt">R</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">z</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">z2mmdy</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="n">end</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">y</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">y2r</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="o">(</span><span class="n">m2mmdr</span><span class="o">,</span> <span class="n">z2mmdr</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="nc">extends</span> <span class="nc">TraversablePolynomialSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">PolynomialFailing</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">TrivialRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">take</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">reducedBy</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">a_r2_r</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">R</span><span class="o">])</span><span class="k">:</span> <span class="kt">R</span> <span class="o">=</span> <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">m</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="n">m2r</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">m2r</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">a_r2_r</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">a2r</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">a2r</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2ob</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">m2ob</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">m</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">fail</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>          <span class="o">(</span><span class="n">m2ob</span><span class="o">,</span> <span class="n">a2ob</span><span class="o">)</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="n">reducer</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="c1">// comment this one out</span>
</span><span class='line'>      <span class="c1">// for</span>
</span><span class='line'>      <span class="c1">// fail fast</span>
</span><span class='line'>      <span class="c1">// instead of</span>
</span><span class='line'>      <span class="c1">// fail slow and accumulate</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">d_a2b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span> <span class="k">=&gt;</span> <span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">m2ob</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">m</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">d_a2b</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">fail</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">m1</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">fail</span><span class="o">(</span><span class="n">m</span> <span class="n">operator</span> <span class="n">m1</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2ob</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">d_a2b</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">a2b</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">one</span><span class="o">(</span><span class="n">a2b</span><span class="o">(</span><span class="n">a</span><span class="o">))</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">m</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">fail</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>          <span class="o">(</span><span class="n">m2ob</span><span class="o">,</span> <span class="n">a2ob</span><span class="o">)</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="n">reducer</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">or</span><span class="o">(</span><span class="n">da1</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2oa</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">m</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">da</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">da</span>
</span><span class='line'>              <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">da1</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2oa</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">one</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]]</span> <span class="k">=</span>
</span><span class='line'>          <span class="o">(</span><span class="n">u2oa</span><span class="o">,</span> <span class="n">a2oa</span><span class="o">)</span>
</span><span class='line'>        <span class="n">da</span> <span class="n">reducedBy</span> <span class="n">reducer</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">u2s</span><span class="k">:</span> <span class="kt">M</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">m</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">s</span><span class="s">&quot; ${m.toString}&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">a2s</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="nc">String</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="n">a</span> <span class="k">=&gt;</span>
</span><span class='line'>            <span class="n">s</span><span class="s">&quot; ${a}&quot;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">reducer</span><span class="k">:</span> <span class="kt">Reducer</span><span class="o">[</span><span class="kt">A</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="o">(</span><span class="n">u2s</span><span class="o">,</span> <span class="n">a2s</span><span class="o">)</span>
</span><span class='line'>        <span class="n">s</span><span class="s">&quot;{${da reducedBy reducer} }&quot;</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">In</span><span class="o">)</span><span class="k">:</span> <span class="kt">Out</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="n">da</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">Failure</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">m</span><span class="k">:</span> <span class="kt">M</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">Success</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">SuccessOrFailure</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>StateModule</h2>

<p><code>StateModule</code> is a <code>StatefulSourceModule</code></p>

<figure class='code'><figcaption><span>StateModule  (StateModule.scala)</span> <a href='/downloads/code/StateModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">StateModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">StatefulSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">StatefulRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">State</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">implicit</span> <span class="k">def</span> <span class="n">toState</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">s_2_snz</span><span class="k">:</span> <span class="kt">S</span> <span class="o">=&gt;</span> <span class="n">S</span> <span class="o">**</span> <span class="n">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="nc">State</span><span class="o">(</span><span class="n">s_2_snz</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="n">z</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">get</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">S</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">set</span><span class="k">:</span> <span class="kt">S</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">s</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="k">_:</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="o">())</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">State</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">s_2_sna</span><span class="k">:</span> <span class="kt">S</span> <span class="o">=&gt;</span> <span class="n">S</span> <span class="o">**</span> <span class="n">A</span><span class="o">)</span>
</span><span class='line'>      <span class="k">extends</span> <span class="nc">StatefulSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">StatefulRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>        <span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">S</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">da</span><span class="o">.</span><span class="n">s_2_sna</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="o">(</span><span class="n">s1</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>              <span class="n">a2db</span><span class="o">(</span><span class="n">a</span><span class="o">).</span><span class="n">s_2_sna</span><span class="o">(</span><span class="n">s1</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">S</span><span class="o">)</span><span class="k">:</span> <span class="kt">S</span> <span class="kt">**</span> <span class="kt">A</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">s_2_sna</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>AsyncModule</h2>

<p><code>AsyncModule</code> is an <code>AsynchronousSourceModule</code></p>

<figure class='code'><figcaption><span>AsyncModule  (AsyncModule.scala)</span> <a href='/downloads/code/AsyncModule.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">object</span> <span class="nc">AsyncModule</span>
</span><span class='line'>    <span class="k">extends</span> <span class="nc">AsynchronousSourceModule</span>
</span><span class='line'>    <span class="k">with</span> <span class="nc">AsynchronousRunnableModule</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">implicit</span> <span class="k">def</span> <span class="n">toSimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">to2z</span><span class="k">:</span> <span class="kt">TimeOut</span> <span class="o">=&gt;</span> <span class="n">Z</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">new</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">override</span> <span class="k">def</span> <span class="n">get</span><span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span>
</span><span class='line'>          <span class="n">to2z</span><span class="o">(</span><span class="n">timeOut</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">implicit</span> <span class="k">def</span> <span class="n">toAsync</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">es_2_sfz</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span> <span class="k">=</span>
</span><span class='line'>      <span class="nc">Async</span><span class="o">(</span><span class="n">es_2_sfz</span><span class="o">)</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">implicit</span> <span class="k">def</span> <span class="n">toRunnable</span><span class="o">(</span><span class="n">u2u</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'>      <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span> <span class="k">def</span> <span class="n">run</span><span class="o">()</span> <span class="k">=</span> <span class="n">u2u</span><span class="o">(())</span> <span class="o">}</span>
</span><span class='line'>    <span class="k">type</span> <span class="kt">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Async</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">one</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">es_2_sfz</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="k">_:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">z</span>
</span><span class='line'>        <span class="n">es_2_sfz</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">async</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span><span class="k">:</span> <span class="o">(</span><span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="kt">Z</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">u2z</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">es_2_sfz</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="n">es</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">atomic</span><span class="k">:</span> <span class="kt">Atomic</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Atomic</span><span class="o">()</span>
</span><span class='line'>            <span class="n">es</span><span class="o">.</span><span class="n">submit</span> <span class="o">{</span>
</span><span class='line'>              <span class="o">(</span><span class="k">_:</span> <span class="kt">Unit</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>                <span class="n">atomic</span><span class="o">.</span><span class="n">setValue</span><span class="o">(</span><span class="n">u2z</span><span class="o">(()))</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>            <span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">atomic</span><span class="o">.</span><span class="n">getValue</span><span class="o">(</span><span class="n">timeOut</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="n">es_2_sfz</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="k">case</span> <span class="k">class</span> <span class="nc">Async</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">es_2_sfa</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span>
</span><span class='line'>      <span class="k">extends</span> <span class="nc">AsynchronousSource</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</span><span class='line'>      <span class="k">with</span> <span class="nc">AsynchronousRunnable</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">{</span> <span class="n">da</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">a2db</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">es_2_sfb</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="n">es</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">startTime</span> <span class="k">=</span> <span class="n">currentTimeMillis</span><span class="o">()</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">es_2_sfa</span><span class="o">(</span><span class="n">es</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="n">timeOut</span><span class="o">)</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">stopTime</span> <span class="k">=</span> <span class="n">currentTimeMillis</span><span class="o">()</span>
</span><span class='line'>            <span class="o">(</span><span class="n">a2db</span><span class="o">(</span><span class="n">a</span><span class="o">)).</span><span class="n">es_2_sfa</span><span class="o">(</span><span class="n">es</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="n">timeOut</span> <span class="o">-</span> <span class="o">(</span><span class="n">stopTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="o">))</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="n">es_2_sfb</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="c1">// comment this one out</span>
</span><span class='line'>      <span class="c1">// for</span>
</span><span class='line'>      <span class="c1">// sequential</span>
</span><span class='line'>      <span class="c1">// instead of parallel</span>
</span><span class='line'>      <span class="k">override</span> <span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">d_a2b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">D</span><span class="o">[</span><span class="kt">A</span> <span class="k">=&gt;</span> <span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">D</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">es_2_sfb</span><span class="k">:</span> <span class="kt">ExecutorService</span> <span class="o">=&gt;</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>          <span class="n">es</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">sfa</span> <span class="k">=</span> <span class="n">es_2_sfa</span><span class="o">(</span><span class="n">es</span><span class="o">)</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">sf_a2b</span> <span class="k">=</span> <span class="n">d_a2b</span><span class="o">.</span><span class="n">es_2_sfa</span><span class="o">(</span><span class="n">es</span><span class="o">)</span>
</span><span class='line'>            <span class="k">val</span> <span class="n">sfb</span> <span class="k">=</span> <span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">val</span> <span class="n">startTime</span> <span class="k">=</span> <span class="n">currentTimeMillis</span><span class="o">()</span>
</span><span class='line'>              <span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">sfa</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="n">timeOut</span><span class="o">)</span>
</span><span class='line'>              <span class="k">val</span> <span class="n">stopTime</span> <span class="k">=</span> <span class="n">currentTimeMillis</span><span class="o">()</span>
</span><span class='line'>              <span class="k">val</span> <span class="n">a2b</span> <span class="k">=</span> <span class="n">sf_a2b</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="n">timeOut</span> <span class="o">-</span> <span class="o">(</span><span class="n">stopTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="o">))</span>
</span><span class='line'>              <span class="n">a2b</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>            <span class="n">sfb</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="n">es_2_sfb</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">run</span><span class="o">(</span><span class="n">es</span><span class="k">:</span> <span class="kt">ExecutorService</span><span class="o">)</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=</span>
</span><span class='line'>        <span class="n">es_2_sfa</span><span class="o">(</span><span class="n">es</span><span class="o">).</span><span class="n">get</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>AsyncModule</code> makes use of the type <code>TimeOut</code>, the <em>trait</em> <code>SimpleFuture</code> and the <em>class</em> <code>Atomic</code></p>

<figure class='code'><figcaption><span>TimeOut  (TimeOut.scala)</span> <a href='/downloads/code/TimeOut.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">type</span> <span class="kt">TimeOut</span> <span class="o">=</span> <span class="nc">Long</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>SimpleFuture  (SimpleFuture.scala)</span> <a href='/downloads/code/SimpleFuture.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">trait</span> <span class="nc">SimpleFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="nc">extends</span> <span class="nc">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">get</span><span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">get</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">get</span><span class="o">(</span><span class="nc">MAX_VALUE</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">get</span><span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">,</span> <span class="n">timeUnit</span><span class="k">:</span> <span class="kt">TimeUnit</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">get</span><span class="o">(</span><span class="nc">MILLISECONDS</span><span class="o">.</span><span class="n">convert</span><span class="o">(</span><span class="n">timeOut</span><span class="o">,</span> <span class="n">timeUnit</span><span class="o">))</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">isDone</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">sys</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;not implemented&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">isCancelled</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">sys</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;not implemented&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">def</span> <span class="n">cancel</span><span class="o">(</span><span class="n">interruptable</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">sys</span><span class="o">.</span><span class="n">error</span><span class="o">(</span><span class="s">&quot;not implemented&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Atomic  (Atomic.scala)</span> <a href='/downloads/code/Atomic.scala'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">class</span> <span class="nc">Atomic</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="k">_</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">countDownLatch</span><span class="k">:</span> <span class="kt">CountDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">getValue</span><span class="o">(</span><span class="n">timeOut</span><span class="k">:</span> <span class="kt">TimeOut</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">countDownLatch</span><span class="o">.</span><span class="n">await</span><span class="o">(</span><span class="n">timeOut</span><span class="o">,</span> <span class="nc">MILLISECONDS</span><span class="o">)</span>
</span><span class='line'>      <span class="n">z</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">setValue</span><span class="o">(</span><span class="n">newZ</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">z</span> <span class="k">=</span> <span class="n">newZ</span>
</span><span class='line'>      <span class="n">countDownLatch</span><span class="o">.</span><span class="n">countDown</span><span class="o">()</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




      </div>
      <div class="col-md-10 col-md-offset-1">
        
        <section id="comment">
            <h1 class="title">Comments</h1>
            <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        </section>
        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>



<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          <a class="pull-left" href="/blog/2014/07/18/embracing-your-rows-with-slick/" title="Previous Post: Embracing your rows with Slick">&laquo; Previous: Embracing your rows with Slick</a>
        

        
      </div>
    </div>
  </div>
</div>

    
    <footer role="contentinfo"><!-- file: _includes/footer.html -->
<footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  
</div>

<div class="col-md-2">

</div>

<!-- file: _includes/end_footer.html -->
<div class="pull-right">
  
</div>


    </div>
  </div>
</footer>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'strongtyped';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.strongtyped.io/blog/2014/10/23/javaone-university-2014/';
        var disqus_url = 'http://www.strongtyped.io/blog/2014/10/23/javaone-university-2014/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




 
  </body>
</html>
