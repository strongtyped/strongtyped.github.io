
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Reactive Programming: Try Versus Future - Strong[Typed]</title>
  <meta name="author" content="StrongTyped.io">

  
  <meta name="description" content="Strong[Typed] blog Reactive Programming: Try Versus Future written May 11, 2014 in Posted by Luc Duponcheel This is a first of two blog posts of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.strongtyped.io/blog/2014/05/11/reactive-programming-try-future">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Strong[Typed]" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50926236-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Exo:400,500,600,500italic,600italic" rel="stylesheet" type="text/css">

</head>

<!-- _layouts/default.html -->
  <body>

    <!-- _layouts/post.html -->

<div class="navbar">
  <div class="navbar-fixed-top">
      <div class="container">
      <ul class="nav navbar-left">
        <li>
          <h2 class="strongtyped"><a href="/"><span class="strong">Strong<span><span class="typed">[Typed]</span></a></h2>
        </li>
      </ul>
      <ul class="nav secondary-nav navbar-nav navbar-right">
  <li><a id="blog-nav" href="/blog">blog</a></li>
</ul>      
    </div>
  </div>
</div>


<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        <h1>Reactive Programming: Try Versus Future</h1>
        <!-- post/metadata.html --> 
<span class="meta">
  written 








  



<time datetime="2014-05-11T06:21:00+02:00" pubdate data-updated="true">May 11, 2014</time>  
in 


<br/>
  

<span class="byline author vcard">Posted by <span class="fn">Luc Duponcheel</span></span>

</span>
        <p>This is a first of two blog posts of about <em>Reactive Programming in Scala</em>.
The blog post about <a href="/blog/2014/05/11/functional-programming-in-scala"><em>Functional Programming in Scala</em></a>
introduced <em>pure computations resulting in exactly one value</em>.
Reactive programming deals, in a functional way,
with two fundamental <em>impure</em> aspects of computations: <em>failure</em> and <em>latency</em>.
The first blog post covers reactive programs resulting in <em>one</em> value.
The second blog post covers Reactive Programs resulting in <em>many</em> (<em>zero or more</em>) values.</p>

<p><strong>Warning:</strong>
The types that are used in this blog post exist in the standard Scala library.
For didactical reasons this blog post sometimes defines extra types and extra methods for existing types.</p>

<!-- more -->


<h2>Failure</h2>

<p>In Java (and many other languages for that matter) failure is modeled using <em>exceptions</em>.
Java also added the distiction between <em>checked</em> and <em>unchecked</em> exceptions.</p>

<p>When asking Java programmers if they <em>like</em> checked exceptions, many of them say they <em>hate</em> them.
In a way this is strange because checked exceptions are part of the <em>contract</em> of your code,
and, when using them, the compiler <em>helps</em> you by telling you whether or not
your code <em>satisfies that contract</em>.
In practice, many Java programmers have the feeling that the compiler is <em>annoying</em>
them rather then helping them.</p>

<p>Why?</p>

<p>Well, because, when trying to satisfy the contract that comes with checked exceptions,
programmers are basically <em>left on their own</em>. As a consequence <code>try/catch</code> code propagates
all the way through their code, cluttering up the <em>essential part</em> of their code.
In a way, when using checked exceptions, <em>they end up in</em> <code>try/catch</code> <em>hell</em>.
Therefore many Java programmers <code>catch</code> checked exceptions and <code>throw</code> unchecked ones.</p>

<p>That makes the situation even worse since, by throwing unchecked exceptions,
programmers let failure <em>silently disappear at compile time</em>
until it <em>loudly re-appears at runtime</em>.</p>

<p>There must be a better way to deal with failure.</p>

<h2>Computations of type <code>Try</code></h2>

<p>The <code>Try</code> type represents a computation that may
either result in a successfully computed value
or result in a failure.
An instance of <code>Try[Z]</code> is
either an instance of <code>Success[Z]</code>
or an instance of <code>Failure[Z]</code>.</p>

<p>Code that makes use a value <code>tz</code> of type <code>Try[Z]</code>,
typically, makes use of a <code>match</code> on <code>tz</code>, which, you can think of as code that</p>

<ul>
<li>in a synchronous (blocking) way, <em>pulls</em> a value or a throwable out of <code>tz</code></li>
</ul>


<h2>Materializing failure using <code>mkTry</code></h2>

<p>A first step towards dealing with failure in a better way is to write, once and for all, code that
<em>materializes failure at compile time</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">mkTry</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">block</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>    <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>      <span class="nc">Success</span> <span class="o">{</span> <span class="n">block</span> <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="n">throwable</span><span class="k">:</span> <span class="kt">Throwable</span> <span class="o">=&gt;</span>
</span><span class='line'>        <span class="nc">Failure</span><span class="o">(</span><span class="n">throwable</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>mkTry</code> code makes use of a <em>call by name</em> parameter <code>block</code>
which you can think of as code that <em>can succeed</em> or <em>can fail</em>.</p>

<p>The standard Scala library already has an <code>apply</code> method in the <code>Try</code> companion
object that is equivalent to <code>mkTry</code>. The definition of <code>mkTry</code> is given for
didactical reasons only.</p>

<p>How are computations of type <code>Try</code> <em>described</em>?</p>

<h2>Describing Computations of type <code>Try</code></h2>

<p>To make things interesting from a failure and latency
point of view, many example computations make use of
the functions <code>work</code> and <code>block</code> below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">work</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Char</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">Long</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span><span class="o">).</span><span class="n">foreach</span> <span class="o">{</span> <span class="k">_</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${c}${Thread.currentThread().getId()}.&quot;</span><span class="o">)</span>
</span><span class='line'>      <span class="nc">Thread</span><span class="o">.</span><span class="n">sleep</span><span class="o">(</span><span class="n">l</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="n">block</span><span class="o">(</span><span class="n">string</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">,</span> <span class="n">c</span><span class="k">:</span> <span class="kt">Char</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">Long</span><span class="o">)</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">work</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">b</span><span class="o">)</span> <span class="n">s</span><span class="s">&quot;${string}Ok&quot;</span>
</span><span class='line'>    <span class="k">else</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">Throwable</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${string}Ko&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here are two computations of type <code>Try</code> that are described using <code>mkTry</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">lazy</span> <span class="k">val</span> <span class="n">okTryFoo</span> <span class="k">=</span> <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">okTryFoo</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">lazy</span> <span class="k">val</span> <span class="n">koTryFoo</span> <span class="k">=</span> <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">okTryFoo</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>A <code>lazy val</code> is used to separate the description of the computation from its execution.</p>

<p>How are computations of type <code>Try</code> <em>executed</em> once they are described?</p>

<h2>Executing Computations of type <code>Try</code></h2>

<p>For the purpose of this series of blog posts,
executing a computation of type <code>Try</code> can be as simple as either printing the value
pulled out of a successful result or printing the message pulled out of an unsuccessful result</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">execute</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">tz</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span>
</span><span class='line'>    <span class="n">tz</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;$z&quot;</span><span class="o">)</span>
</span><span class='line'>      <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;${t.getMessage}&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Below, the two computations of type <code>Try</code> are executed using <code>execute</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">okTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">okTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">fooOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">koTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">koTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, what does materialized failure bring you?</p>

<h2><code>bnd</code> is your guide</h2>

<p>Just as it is possible for computations of type <code>One</code> it is possible for computations of type <code>Try</code>
to define a method <code>bnd</code> that can be used to <em>compose computations</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">TryOps</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">tz</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">Y</span><span class="o">](</span><span class="n">z2ty</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="nc">Try</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Y</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>      <span class="n">tz</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="n">z</span> <span class="n">bind</span> <span class="n">z2ty</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>          <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>An important requirement for <code>z2ty</code> is that it <em>must not throw exceptions</em>.
Using <code>mkTry</code>, it is easy to fulfill this requirement.</p>

<p>With <code>bnd</code> in your toolbox, you are not on your own any more to deal with materialized failure.
Indeed, the method <code>bnd</code> is your trustworthy guide that</p>

<ul>
<li><em>leads you through the successful execution path</em></li>
<li><em>does the failure related boilerplate work for you</em></li>
</ul>


<h2>DSL for declaring computations of type <code>Try</code> (Part 1)</h2>

<p>By now we have defined <code>mkTry</code> and <code>bnd</code></p>

<ul>
<li>They constitute <em>a declarative DSL for describing computations</em> of type <code>Try</code></li>
</ul>


<p>We have also defined <code>execute</code></p>

<ul>
<li>It constitutes <em>an imperative DSL for executing computations</em> of type <code>Try</code></li>
</ul>


<p>This section contains some examples on how to make use of those DSL&rsquo;s.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">:</span><span class="kt">paste</span>
</span><span class='line'><span class="c1">// Entering paste mode (ctrl-D to finish)</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar01</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar02</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar03</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar04</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Exiting paste mode, now interpreting.</span>
</span><span class='line'>
</span><span class='line'><span class="n">tryFooBar01</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar02</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar03</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar04</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can now, so to speak, try to print <code>fooOkbarOk</code> in a synchronous way</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar01</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">fooOkbarOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar02</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">barKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar03</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar04</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now that failure is dealt with for you, you are perfectly happy, right?
Well, maybe not.
<code>bnd</code> deals with failure in a somewhat specific way using a <em>fail fast</em> strategy.
Maybe what you want is a <em>fail slow</em> strategy that <em>accumulates</em> information about what went wrong along the way.</p>

<p>This is where <code>and</code> comes in.</p>

<h2><code>and</code> may be a better guide</h2>

<p>Just as it is possible for computations of type <code>One</code> it is possible for computations of type <code>Try</code>
to define a method <code>and</code> that can be used to <em>compose computations</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">Y</span><span class="o">](</span><span class="n">t_z2y</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Z</span> <span class="k">=&gt;</span> <span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Y</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="o">(</span><span class="n">tz</span><span class="o">,</span> <span class="n">t_z2y</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="o">(</span><span class="nc">Success</span><span class="o">(</span><span class="n">z</span><span class="o">),</span> <span class="nc">Success</span><span class="o">(</span><span class="n">z2y</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="nc">Try</span> <span class="o">{</span> <span class="n">z</span> <span class="n">bind</span> <span class="n">z2y</span> <span class="o">}</span>
</span><span class='line'>    <span class="k">case</span> <span class="o">(</span><span class="nc">Success</span><span class="o">(</span><span class="k">_</span><span class="o">),</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="o">(</span><span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">),</span> <span class="nc">Success</span><span class="o">(</span><span class="k">_</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="o">(</span><span class="nc">Failure</span><span class="o">(</span><span class="n">t1</span><span class="o">),</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t2</span><span class="o">))</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="nc">Failure</span><span class="o">(</span><span class="k">new</span> <span class="nc">Throwable</span><span class="o">(</span>
</span><span class='line'>          <span class="n">t1</span><span class="o">.</span><span class="n">getMessage</span> <span class="o">+</span>
</span><span class='line'>          <span class="s">&quot; and &quot;</span> <span class="o">+</span>
</span><span class='line'>          <span class="n">t2</span><span class="o">.</span><span class="n">getMessage</span><span class="o">))</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Instead of relying on the default implementation of <code>and</code>
(that would use a fail fast strategy), you can take advantage of
the possibility to define <code>and</code> in another way to let it use a fail slow strategy
and accumulate error messages. All this is possible since <code>and</code>
is more abstract as <code>bnd</code> and, as such, allows for more implementation flexibility.</p>

<p>By the way: it is absolutely not the case that this is the one and only way
to use a fail slow strategy and accumulate information about what went wrong.
It is better to make use of a more powerful type, like the <code>Validation</code> type of ScalaZ.
The point we want to make is that, when going for <code>and</code> as a guide,
you have more failure handling implementation flexibility for letting
<code>and</code> guide you along your way to a possible result.</p>

<h2>DSL for declaring computations of type <code>Try</code> (Part 2)</h2>

<p>By now we have defined <code>mkTry</code>, <code>bnd</code> and <code>and</code></p>

<ul>
<li>They constitute <em>a declarative DSL for describing computations</em> of type <code>Try</code></li>
</ul>


<p>We have also defined <code>execute</code></p>

<ul>
<li>It constitutes <em>an imperative DSL for executing computations</em> of type <code>Try</code></li>
</ul>


<p>This section contains some examples on how to make use of those DSL&rsquo;s.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar05</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar06</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar07</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFooBar08</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Exiting paste mode, now interpreting.</span>
</span><span class='line'>
</span><span class='line'><span class="n">tryFooBar05</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar06</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar07</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFooBar08</span><span class="k">:</span> <span class="kt">scala.util.Try</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can now, so to speak, try to print <code>fooOkbarOk</code> in a synchronous way</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar05</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooOkbarOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar06</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar07</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">barKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFooBar08</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">B142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span>
</span><span class='line'><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">F142</span><span class="o">.</span><span class="n">barKo</span> <span class="n">and</span> <span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>So far so good as far as <em>failure</em> is concerned. But what about <em>latency</em>?
All code we have shown so far uses <em>synchronous, blocking</em> computations.</p>

<h2>Latency</h2>

<p>You all know that making use of <em>synchronous, blocking</em> computations
is not the way to deal with latency.
In Java (and many other languages for that matter) <em>asynchronous, non-blocking</em> computations
are used instead to deal with latency.
Asynchronous computations are often modeled using <em>callbacks</em>.</p>

<p>When asking programmers if they <em>like</em> callbacks, many of them say they <em>hate</em> them.</p>

<p>Why?</p>

<p>Well, because, when trying to deal with latency using callbacks,
programmers are basically <em>left on their own</em>.
In a way, when using callbacks, <em>they end up in callback hell</em>.</p>

<p>There must be a better way to deal with latency.</p>

<h2>Computations of type <code>Future</code></h2>

<p>A value of type <code>Try[Z]</code> that is defined as a <code>def</code>
is essentially the same as a value of type <code>Unit =&gt; Try[Z]</code>.
The <em>dual</em> of such a value, obtained by reversing the arrow <code>=&gt;</code>,
is a value of type <code>Try[Z] =&gt; Unit</code>. This dual is formalized by the
following type definition</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">type</span> <span class="kt">Callback</span><span class="o">[</span><span class="kt">-Z</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Unit</span>
</span></code></pre></td></tr></table></div></figure>


<p>In a way (as illustrated in the following section) a <code>Future[Z]</code> value is the <em>dual</em> of a <code>Callback[Z]</code> value,
and, as such, the <em>bi-dual</em> of a <code>Try[Z]</code> value.</p>

<p>More precisely, in a way, <code>Future[Z]</code> is the same as <code>Callback[Z] =&gt; Unit</code>,
which is the same as <code>(Try[Z] =&gt; Unit) =&gt; Unit</code>.</p>

<p>This <em>bi-duality</em> turns out to transform synchronous <code>Try</code> computations
into asynchronous <code>Future</code> computations.</p>

<h2>Materializing (failure and) latency using <code>mkFuture</code></h2>

<p>A first step towards dealing with (failure and) latency is to write,
once and for all, code that <em>materializes (failure and) latency at compile time</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">mkFuture</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span>
</span><span class='line'>    <span class="o">(</span><span class="n">cz2u</span><span class="k">:</span> <span class="kt">Callback</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span>
</span><span class='line'>    <span class="o">(</span><span class="k">implicit</span> <span class="n">executionContext</span><span class="k">:</span> <span class="kt">ExecutionContext</span><span class="o">)</span>
</span><span class='line'>    <span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">pz</span> <span class="k">=</span> <span class="nc">Promise</span><span class="o">[</span><span class="kt">Z</span><span class="o">]()</span>
</span><span class='line'>    <span class="n">executionContext</span><span class="o">.</span><span class="n">prepare</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">run</span> <span class="o">{</span> <span class="o">{</span> <span class="o">(</span><span class="n">tz</span><span class="k">:</span> <span class="kt">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="n">pz</span><span class="o">.</span><span class="n">complete</span><span class="o">(</span><span class="n">tz</span><span class="o">)</span> <span class="o">;</span> <span class="o">()</span> <span class="o">}</span> <span class="n">bind</span> <span class="n">cz2u</span> <span class="o">}</span>
</span><span class='line'>    <span class="o">})</span>
</span><span class='line'>    <span class="n">pz</span><span class="o">.</span><span class="n">future</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code above uses the <code>Promise[Z]</code> class in its implementation.</p>

<p>You do not need to fully understand the <em>definition</em> of <code>mkFuture</code>.
Think of it as the <em>dual</em> of <em>fulfilling a promise</em> in a separate thead,
and returning that promise as a future.</p>

<p>In a way a <code>Promise[Z]</code> is both a <code>Callback[-Z]</code>,
since it has a method <code>complete</code> that has a parameter of type <code>Try[Z]</code>,
and a <code>Future[+Z]</code>,
since it has a variable <code>future</code> of type <code>Future[Z]</code>.</p>

<p>A promise is something that</p>

<ul>
<li>can be fulfilled (written) only once, in a thread safe way</li>
<li>can be pushed (and read) many times.</li>
</ul>


<p>It is possible, and often useful, to define futures directly in terms of promises.
This blog post does not go into details.</p>

<p>This definition of computations in terms of <code>mkFuture</code> is, in a way,
more complex than needed. For the moment, we are dealing
with reactive computations with <em>one</em> value.
Reactive computations with <em>many</em> values will be defined
in the next blog post a in similar way.
We want to emphasize this analogy.</p>

<p>When considering <code>mkFuture</code> as the <em>only</em> way to
make a future, in a way, <code>Future[Z]</code> becomes the same as <code>Callback[Z] =&gt; Unit</code>.</p>

<p>A callback can be <em>registered</em> to a future as shown below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">FutureOps</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">fz</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">register</span><span class="o">(</span><span class="n">callback</span><span class="k">:</span> <span class="kt">Callback</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">fz</span><span class="o">.</span><span class="n">onComplete</span> <span class="o">{</span> <span class="n">tz</span> <span class="k">=&gt;</span>
</span><span class='line'>        <span class="n">callback</span><span class="o">(</span><span class="n">tz</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>The standard Scala library already has an <code>onComplete</code> method in the <code>Future</code> class
that is equivalent to <code>register</code>. The definition of <code>register</code> is given for didactical reasons only.</p>

<p>It is important that you understand the <em>usage</em> of <code>mkFuture</code></p>

<ul>
<li>you can make a future by defining what it <em>pushes</em> to registered callbacks</li>
</ul>


<p>Not surprising, a computation of type <code>Try</code> can be transformed to a computation
of type <code>Future</code> using this idea</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">try2future</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">tz</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Try</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>    <span class="n">mkFuture</span> <span class="o">{</span> <span class="n">cz</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">cz</span><span class="o">(</span><span class="n">tz</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>try2future</code> code makes use of a <em>call by name</em> parameter <code>tz</code>.</p>

<p>The example below illustrates how to use <code>try2future</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'>  <span class="k">def</span> <span class="n">mkFutureTry</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">block</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>    <span class="n">try2future</span><span class="o">(</span><span class="n">mkTry</span> <span class="o">{</span> <span class="n">block</span> <span class="o">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>mkTry</code> function for computations of type <code>Try</code> could naturally be reused.</p>

<p>The <code>mkFutureTry</code> code makes use of a <em>call by name</em> parameter <code>block</code>
which you can think of as code that
on the one hand, <em>can succeed</em> or <em>can fail</em> and,
on the other hand, <em>can take some time to be evaluated</em>.</p>

<p>How are computations of type <code>Future</code> described?</p>

<h2>Describing Computations of type <code>Future</code></h2>

<p>Here are two computations of type <code>Future</code> that are described using <code>mkFutureTry</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">lazy</span> <span class="k">val</span> <span class="n">okFutureTryFoo</span> <span class="k">=</span> <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">okFutureTryFoo</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">lazy</span> <span class="k">val</span> <span class="n">koFutureTryFoo</span> <span class="k">=</span> <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">koFutureTryFoo</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>How are computations of type <code>Future</code> <em>executed</em> once they are described?</p>

<h2>Executing Computations of type <code>Future</code></h2>

<p>For the purpose of this series of blog posts,
executing a computation of type <code>Future</code> can be as simple as registering a callback
that either prints the value of a successful result pushed to it or prints the message of an unsuccessful result
pushed to it</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'> <span class="k">def</span> <span class="n">execute</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">fz</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span>
</span><span class='line'>   <span class="n">fz</span><span class="o">.</span><span class="n">register</span> <span class="o">{</span> <span class="n">tz</span> <span class="k">=&gt;</span>
</span><span class='line'>     <span class="n">execute</span><span class="o">(</span><span class="n">tz</span><span class="o">)</span>
</span><span class='line'>   <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>execute</code> function for computations of type <code>Try</code> could naturally be reused.</p>

<p>Below, the two computations of type <code>Future</code> are executed using <code>execute</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">okFutureTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">120</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">F121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">fooOkM142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">okFutureTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">120</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">fooOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">koFutureTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">120</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span>
</span><span class='line'><span class="o">.</span><span class="n">B121</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">koFutureTryFoo</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">120</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, what does materialized (failure and) latency bring you?</p>

<h2><code>bnd</code> is your guide</h2>

<p>Just as it is possible for computations of type <code>Try</code> it is possible for computations of type <code>Future</code> to define a method <code>bnd</code> that can be used to <em>compose computations</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="k">def</span> <span class="n">bnd</span><span class="o">[</span><span class="kt">Y</span><span class="o">](</span><span class="n">z2fy</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=&gt;</span> <span class="nc">Future</span><span class="o">[</span><span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">py</span> <span class="k">=</span> <span class="nc">Promise</span><span class="o">[</span><span class="kt">Y</span><span class="o">]()</span>
</span><span class='line'>  <span class="n">fz</span><span class="o">.</span><span class="n">register</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">z</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="o">(</span><span class="n">z</span> <span class="n">bind</span> <span class="n">z2fy</span><span class="o">).</span><span class="n">register</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Success</span><span class="o">(</span><span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">py</span><span class="o">.</span><span class="n">success</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
</span><span class='line'>        <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">py</span><span class="o">.</span><span class="n">failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="k">case</span> <span class="nc">Failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">py</span><span class="o">.</span><span class="n">failure</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="n">py</span><span class="o">.</span><span class="n">future</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>An important requirement for <code>z2fy</code> is that it must not throw exceptions. Using <code>mkFutureTry</code>, it is easy to fulfill this requirement.</p>

<p>With <code>bnd</code> in your toolbox, you are not on your own any more to deal with materialized (failure and) latency. Indeed, the method <code>bnd</code> is your trustworthy guide that</p>

<ul>
<li><em>leads you through the successful execution path</em></li>
<li><em>does the (failure and) latency related boilerplate work for you</em></li>
</ul>


<h2>DSL for declaring computations of type <code>Future</code> (Part 1)</h2>

<p>By now we have defined <code>mkFutureTry</code> and <code>bnd</code></p>

<ul>
<li>They constitute <em>a declarative DSL for describing computations</em> of type <code>Future</code></li>
</ul>


<p>We have also defined <code>execute</code></p>

<ul>
<li>It constitutes <em>an imperative DSL for executing computations</em> of type <code>Future</code></li>
</ul>


<p>This section contains some examples on how to make use of those DSL&rsquo;s.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="k">:</span><span class="kt">paste</span>
</span><span class='line'><span class="c1">// Entering paste mode (ctrl-D to finish)</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar01</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar02</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar03</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar04</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">s</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">bnd</span> <span class="o">{</span> <span class="n">t</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">s</span><span class="o">)(</span><span class="n">t</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Exiting paste mode, now interpreting.</span>
</span><span class='line'>
</span><span class='line'><span class="n">tryFutureFooBar01</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar02</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar03</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar04</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can now, so to speak, try to print <code>fooOkbarOk</code> in an asynchronous way</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar01</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">300</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F149</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">fooOkbarOkM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar02</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">300</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F152</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F152</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">B151</span><span class="o">.</span><span class="n">barKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar03</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">300</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar04</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;M</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">300</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">F151</span><span class="o">.</span><span class="n">fooKoM142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span><span class='line'><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span><span class="n">M142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now that latency is also dealt with for you, you are perfectly happy, right?
Well, maybe not.
<code>bnd</code> deals with latency in a somewhat specific (not to say sub-optimal) way using <em>sequential</em> composition. Maybe what you want is a <em>parallel</em> composition.</p>

<h2><code>and</code> may be a better guide</h2>

<p>Just as it is possible for computations of type <code>Try</code> it is possible for computations of type <code>Future</code>
to define a method <code>and</code> that can be used to <em>compose computations</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">and</span><span class="o">[</span><span class="kt">Y</span><span class="o">](</span><span class="n">f_z2y</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Z</span> <span class="k">=&gt;</span> <span class="kt">Y</span><span class="o">])</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">py</span> <span class="k">=</span> <span class="nc">Promise</span><span class="o">[</span><span class="kt">Y</span><span class="o">]()</span>
</span><span class='line'>  <span class="n">fz</span><span class="o">.</span><span class="n">register</span> <span class="o">{</span> <span class="n">tz</span> <span class="k">=&gt;</span>
</span><span class='line'>    <span class="n">f_z2y</span><span class="o">.</span><span class="n">register</span> <span class="o">{</span> <span class="n">t_z2y</span> <span class="k">=&gt;</span>
</span><span class='line'>      <span class="n">py</span><span class="o">.</span><span class="n">complete</span><span class="o">(</span><span class="n">tz</span> <span class="n">and</span> <span class="n">t_z2y</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="n">py</span><span class="o">.</span><span class="n">future</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>and</code> method for computations of type <code>Try</code> could naturally be reused.</p>

<p>Instead of relying on the default implementation of <code>and</code>
(that would use sequential composition), you can take advantage of
the possibility to define <code>and</code> in another way to let it use parallel composition
All this is possible since <code>and</code>
is more abstract as <code>bnd</code> and, as such, allows for more implementation flexibility.</p>

<p>The point we want to make is that, when going for <code>and</code> as a guide,
you have more latency handling implementation flexibility for letting
<code>and</code> guide you along your way to a possible result.</p>

<h2>DSL for declaring computations of type <code>Try</code> (Part 2)</h2>

<p>By now we have defined <code>mkFutureTry</code>, <code>bnd</code> and <code>and</code></p>

<ul>
<li>They constitute <em>a declarative DSL for describing computations</em> of type <code>Try</code></li>
</ul>


<p>We have also defined <code>execute</code></p>

<ul>
<li>It constitutes <em>an imperative DSL for executing computations</em> of type <code>Try</code></li>
</ul>


<p>This section contains some examples on how to make use of those DSL&rsquo;s.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// Entering paste mode (ctrl-D to finish)</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar05</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar06</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar07</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar08</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Exiting paste mode, now interpreting.</span>
</span><span class='line'>
</span><span class='line'><span class="n">tryFutureFooBar05</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar06</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar07</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar08</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can now, so to speak, try to print <code>fooOkbarOk</code> in an asynchronous way</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar05</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B149</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F154</span><span class="o">.</span><span class="n">fooOkbarOkW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar06</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B154</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">fooKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar07</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B154</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">B154</span>
</span><span class='line'><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B154</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F149</span><span class="o">.</span><span class="n">barKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar08</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B149</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">B149</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F155</span><span class="o">.</span><span class="n">barKo</span> <span class="n">and</span> <span class="n">fooKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the examples above,
the <code>block</code> using <code>"bar"</code> is executed faster than
the <code>block</code> using <code>"foo"</code>.
So what about the opposite?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// Entering paste mode (ctrl-D to finish)</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar09</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar10</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar11</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">lazy</span> <span class="k">val</span> <span class="n">tryFutureFooBar12</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
</span><span class='line'>  <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;B</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mkFutureTry</span> <span class="o">{</span> <span class="n">block</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="-Symbol">&#39;F</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span> <span class="o">}</span> <span class="n">and</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">mkFutureTry</span><span class="o">(</span><span class="n">add</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Exiting paste mode, now interpreting.</span>
</span><span class='line'>
</span><span class='line'><span class="n">tryFutureFooBar09</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar10</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar11</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">tryFutureFooBar12</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">&lt;</span><span class="k">lazy</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can now, again, so to speak, try to print <code>fooOkbarOk</code> in an asynchronous way</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar09</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B155</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">F157</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">fooOkbarOkW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar10</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B155</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">F159</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">fooKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar11</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">barKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span><span class='line'><span class="n">scala</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">execute</span><span class="o">(</span><span class="n">tryFutureFooBar12</span><span class="o">)</span> <span class="o">;</span> <span class="n">work</span><span class="o">(</span><span class="-Symbol">&#39;W</span><span class="err">&#39;</span><span class="o">,</span> <span class="mi">150</span><span class="o">)</span> <span class="o">}</span>
</span><span class='line'><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span>
</span><span class='line'><span class="n">W142</span><span class="o">.</span><span class="n">F158</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">B155</span><span class="o">.</span><span class="n">barKo</span> <span class="n">and</span> <span class="n">fooKoW142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span><span class="n">W142</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the examples above,
the <code>block</code> using <code>"foo"</code> is executed faster than
the <code>block</code> using <code>"bar"</code>.</p>

      </div>
      <div class="col-md-10 col-md-offset-1">
        
        <section id="comment">
            <h1 class="title">Comments</h1>
            <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        </section>
        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>



<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          <a class="pull-left" href="/blog/2014/05/11/functional-programming-in-scala/" title="Previous Post: Functional Programming in Scala">&laquo; Previous: Functional Programming in Scala</a>
        

        
          <a class="pull-right" href="/blog/2014/05/14/reactive-programming-notification-observable/" title="Next Post: Reactive Programming: Notification versus Observable">Next: Reactive Programming: Notification versus Observable &raquo;</a>
        
      </div>
    </div>
  </div>
</div>

    
    <footer role="contentinfo"><!-- file: _includes/footer.html -->
<footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  
</div>

<div class="col-md-2">

</div>

<!-- file: _includes/end_footer.html -->
<div class="pull-right">
  
</div>


    </div>
  </div>
</footer>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'strongtyped';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.strongtyped.io/blog/2014/05/11/reactive-programming-try-future/';
        var disqus_url = 'http://www.strongtyped.io/blog/2014/05/11/reactive-programming-try-future/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




 
  </body>
</html>
